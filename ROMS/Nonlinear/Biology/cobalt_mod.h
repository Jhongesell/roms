!
!  Parameters for GFDL Cobalt model:                                 !
!
! init  initialisation  N/A !
!
! htotal_scale_lo  htotal_scale_lo ?  N/A !
!
! htotal_scale_hi  htotal_scale_hi ?  N/A !
!
! RHO_0  sea water density  N/A !
!
! NKML  NKML ?  N/A !
!
! a_0  a_0 : coefficients for O2 saturation  N/A !
!
! a_1  a_1 : coefficients for O2 saturation  N/A !
!
! a_2  a_2 : coefficients for O2 saturation  N/A !
!
! a_3  a_3 : coefficients for O2 saturation  N/A !
!
! a_4  a_4 : coefficients for O2 saturation  N/A !
!
! a_5  a_5 : coefficients for O2 saturation  N/A !
!
! b_0  b_0 : coefficients for O2 saturation  N/A !
!
! b_1  b_1 : coefficients for O2 saturation  N/A !
!
! b_2  b_2 : coefficients for O2 saturation  N/A !
!
! b_3  b_3 : coefficients for O2 saturation  N/A !
!
! c_0  c_0 : coefficients for O2 saturation  N/A !
!
! a1_co2  a1_co2 : Compute the Schmidt number of CO2 in seawater  N/A !
!
! a2_co2  a2_co2 : Compute the Schmidt number of CO2 in seawater  N/A !
!
! a3_co2  a3_co2 : Compute the Schmidt number of CO2 in seawater  N/A !
!
! a4_co2  a4_co2 : Compute the Schmidt number of CO2 in seawater  N/A !
!
! a1_o2  a1_o2 : Compute the Schmidt number of O2 in seawater  N/A !
!
! a2_o2  a2_o2 : Compute the Schmidt number of O2 in seawater  N/A !
!
! a3_o2  a3_o2 : Compute the Schmidt number of O2 in seawater  N/A !
!
! a4_o2  a4_o2 : Compute the Schmidt number of O2 in seawater  N/A !
!
! mass_2_n  mass_2_n: Stoichiometry  g mol N-1 !
!
! n_2_n_denit  n_2_n_denit: Stoichiometry  mol N NO3 mol N org-1 !
!
! o2_2_c  o2_2_c: Stoichiometry  mol O2 mol C-1 !
!
! o2_2_nfix  o2_2_nfix: Stoichiometry  mol O2 mol N-1 !
!
! o2_2_nh4  o2_2_nh4: Stoichiometry  mol O2 mol N-1 !
!
! o2_2_nitrif  o2_2_nitrif: Stoichiometry  mol O2 mol N-1 !
!
! o2_2_no3  o2_2_no3: Stoichiometry  mol O2 mol N-1 !
!
! k_fed_Di  k_fed_Di: Nutrient Limitation Parameters (phytoplankton)  mol Fed kg-1 !
!
! k_fed_Lg  k_fed_Lg: Nutrient Limitation Parameters (phytoplankton)  mol Fed kg-1 !
!
! k_fed_Sm  k_fed_Sm: Nutrient Limitation Parameters (phytoplankton)  mol Fed kg-1 !
!
! k_nh4_Lg  k_nh4_Lg: Nutrient Limitation Parameters (phytoplankton)  mol NH4 kg-1 !
!
! k_nh4_Sm  k_nh4_Sm: Nutrient Limitation Parameters (phytoplankton)  mol NH4 kg-1 !
!
! k_nh4_Di  k_nh4_Di: Nutrient Limitation Parameters (phytoplankton)  mol NH4 kg-1 !
!
! k_no3_Lg  k_no3_Lg: Nutrient Limitation Parameters (phytoplankton)  mol NO3 kg-1 !
!
! k_no3_Sm  k_no3_Sm: Nutrient Limitation Parameters (phytoplankton)   mol NO3 kg-1 !
!
! k_no3_Di  k_no3_Di: Nutrient Limitation Parameters (phytoplankton)   mol NO3 kg-1 !
!
! k_po4_Di  k_po4_Di: Nutrient Limitation Parameters (phytoplankton)   mol PO4 kg-1 !
!
! k_po4_Lg  k_po4_Lg: Nutrient Limitation Parameters (phytoplankton)   mol PO4 kg-1 !
!
! k_po4_Sm  k_po4_Sm: Nutrient Limitation Parameters (phytoplankton)   mol PO4 kg-1 !
!
! k_sio4_Lg  k_sio4_Lg: Nutrient Limitation Parameters (phytoplankton)   mol SiO4 kg-1 !
!
! k_fe_2_n_Di  k_fe_2_n_Di: Nutrient Limitation Parameters (phytoplankton)   mol Fe mol N-1 !
!
! k_fe_2_n_Lg  k_fe_2_n_Lg: Nutrient Limitation Parameters (phytoplankton)   mol Fe mol N-1 !
!
! k_fe_2_n_Sm  k_fe_2_n_Sm: Nutrient Limitation Parameters (phytoplankton)   mol Fe mol N-1 !
!
! fe_2_n_max_Sm  fe_2_n_max_Sm: Nutrient Limitation Parameters (phytoplankton)  mol Fe mol N-1 !
!
! fe_2_n_max_Lg  fe_2_n_max_Lg: Nutrient Limitation Parameters (phytoplankton)  mol Fe mol N-1 !
!
! fe_2_n_max_Di  fe_2_n_max_Di: Nutrient Limitation Parameters (phytoplankton)  mol Fe mol N-1 !
!
! fe_2_n_upt_fac  fe_2_n_upt_fac: Nutrient Limitation Parameters (phytoplankton)  mol Fe mol N-1 !
!
! alpha_Di  alpha_Di: Phytoplankton light limitation/growth rate  g C g Chl-1 m2 W-1 s-1 !
!
! alpha_Lg  alpha_Lg: Phytoplankton light limitation/growth rate  g C g Chl-1 m2 W-1 s-1 !
!
! alpha_Sm  alpha_Sm: Phytoplankton light limitation/growth rate  g C g Chl-1 m2 W-1 s-1 !
!
! kappa_eppley  kappa_eppley: Phytoplankton light limitation/growth rate  deg C-1 !
!
! P_C_max_Di  P_C_max_Di: Phytoplankton light limitation/growth rate  s-1 !
!
! P_C_max_Lg  P_C_max_Lg: Phytoplankton light limitation/growth rate  s-1 !
!
! P_C_max_Sm  P_C_max_Sm: Phytoplankton light limitation/growth rate  s-1 !
!
! thetamax_Di  thetamax_Di: Phytoplankton light limitation/growth rate  g Chl g C-1 !
!
! thetamax_Lg  thetamax_Lg: Phytoplankton light limitation/growth rate  g Chl g C-1 !
!
! thetamax_Sm  thetamax_Sm: Phytoplankton light limitation/growth rate  g Chl g C-1 !
!
! bresp_Di  bresp_Di: Phytoplankton light limitation/growth rate  sec-1 !
!
! bresp_Lg  bresp_Lg: Phytoplankton light limitation/growth rate  sec-1 !
!
! bresp_Sm  bresp_Sm: Phytoplankton light limitation/growth rate  sec-1 !
!
! thetamin  thetamin: Phytoplankton light limitation/growth rate  g Chl g C-1 !
!
! thetamin_nolim  thetamin_nolim: Phytoplankton light limitation/growth rate  g Chl g C-1 !
!
! zpllgr  zpllgr: Phytoplankton light limitation/growth rate  dimensionless !
!
! gamma_irr_mem  gamma_irr_mem: Phytoplankton light limitation/growth rate  s-1 !
!
! k_n_inhib_Di  k_n_inhib_Di: Nitrogen fixation inhibition parameters  mol NO3 kg-1 !
!
! o2_inhib_Di_pow  o2_inhib_Di_pow: Nitrogen fixation inhibition parameters  mol O2-1 m3 !
!
! o2_inhib_Di_sat  o2_inhib_Di_sat: Nitrogen fixation inhibition parameters  mol O2 kg-1 !
!
! p_2_n_static  p_2_n_static: Other stoichiometry  N/A !
!
! c_2_n  c_2_n: Other stoichiometry  N/A !
!
! alk_2_n_denit  alk_2_n_denit: Other stoichiometry  eq. alk mol NO3-1 !
!
! p_2_n_static_Di  p_2_n_static_Di: Other stoichiometry  mol P mol N-1 !
!
! p_2_n_static_Lg  p_2_n_static_Lg: Other stoichiometry  mol P mol N-1 !
!
! p_2_n_static_Sm  p_2_n_static_Sm: Other stoichiometry  mol P mol N-1 !
!
! si_2_n_static_Lg  si_2_n_static_Lg: Other stoichiometry  mol Si mol N-1 !
!
! si_2_n_max_Lg  si_2_n_max_Lg: Other stoichiometry  mol Si mol N-1 !
!
! ca_2_n_arag  ca_2_n_arag: Other stoichiometry  mol Ca mol N-1 !
!
! ca_2_n_calc  ca_2_n_calc: Other stoichiometry  mol Ca mol N-1 !
!
! caco3_sat_max  caco3_sat_max: Other stoichiometry  dimensionless !
!
! q_p_2_n_smz  q_p_2_n_smz: Zooplankton Stoichiometry - presently static  mol P mol N-1 !
!
! q_p_2_n_mdz  q_p_2_n_mdz: Zooplankton Stoichiometry - presently static  mol P mol N-1 !
!
! q_p_2_n_lgz  q_p_2_n_lgz: Zooplankton Stoichiometry - presently static  mol P mol N-1 !
!
! q_p_2_n_bact  q_p_2_n_bact: Bacteria Stoichiometry - presently static  mol P mol N-1 !
!
! agg_Sm  agg_Sm: Phytoplankton aggregation  s-1 (mole N kg)-1 !
!
! agg_Di  agg_Di: Phytoplankton aggregation  s-1 (mole N kg)-1 !
!
! agg_Lg  agg_Lg: Phytoplankton aggregation  s-1 (mole N kg)-1 !
!
! vir_Sm  vir_Sm: Phytoplankton and bacterial losses to viruses  s-1 (mole N kg)-1 !
!
! vir_Di  vir_Di: Phytoplankton and bacterial losses to viruses  s-1 (mole N kg)-1 !
!
! vir_Lg  vir_Lg: Phytoplankton and bacterial losses to viruses  s-1 (mole N kg)-1 !
!
! vir_Bact  vir_Bact: Phytoplankton and bacterial losses to viruses  s-1 (mole N kg)-1 !
!
! ktemp_vir  ktemp_vir: Phytoplankton and bacterial losses to viruses  C-1 !
!
! exu_Sm  exu_Sm: Phytoplankton losses to exudation  dimensionless (fraction of NPP) !
!
! exu_Di  exu_Di: Phytoplankton losses to exudation  dimensionless (fraction of NPP) !
!
! exu_Lg  exu_Lg: Phytoplankton losses to exudation  dimensionless (fraction of NPP) !
!
! imax_smz  imax_smz: Zooplankton ingestion parameterization and temperature dependence  s-1 !
!
! imax_mdz  imax_mdz: Zooplankton ingestion parameterization and temperature dependence  s-1 !
!
! imax_lgz  imax_lgz: Zooplankton ingestion parameterization and temperature dependence  s-1 !
!
! ki_smz  ki_smz: Zooplankton ingestion parameterization and temperature dependence  moles N kg-1 !
!
! ki_mdz  ki_mdz: Zooplankton ingestion parameterization and temperature dependence  moles N kg-1 !
!
! ki_lgz  ki_lgz: Zooplankton ingestion parameterization and temperature dependence  moles N kg-1 !
!
! ktemp_smz  ktemp_smz: Zooplankton ingestion parameterization and temperature dependence  C-1 !
!
! ktemp_mdz  ktemp_mdz: Zooplankton ingestion parameterization and temperature dependence  C-1 !
!
! ktemp_lgz  ktemp_lgz: Zooplankton ingestion parameterization and temperature dependence  C-1 !
!
! mu_max_bact  mu_max_bact: Bacterial growth and uptake parameters  s-1 !
!
! k_ldon_bact  k_ldon_bact: Bacterial growth and uptake parameters  mol ldon kg-1 !
!
! ktemp_bact  ktemp_bact: Bacterial growth and uptake parameters  C-1 !
!
! nswitch_smz  nswitch_smz: Zooplankton switching and prey preference parameters  dimensionless !
!
! nswitch_mdz  nswitch_mdz: Zooplankton switching and prey preference parameters  dimensionless !
!
! nswitch_lgz  nswitch_lgz: Zooplankton switching and prey preference parameters  dimensionless !
!
! mswitch_smz  mswitch_smz: Zooplankton switching and prey preference parameters  dimensionless !
!
! mswitch_mdz  mswitch_mdz: Zooplankton switching and prey preference parameters  dimensionless !
!
! mswitch_lgz  mswitch_lgz: Zooplankton switching and prey preference parameters  dimensionless !
!
! smz_ipa_smp  smz_ipa_smp: Zooplankton switching and prey preference parameters  dimensionless !
!
! smz_ipa_lgp  smz_ipa_lgp: Zooplankton switching and prey preference parameters  dimensionless !
!
! smz_ipa_diaz  smz_ipa_diaz: Zooplankton switching and prey preference parameters  dimensionless !
!
! smz_ipa_smz  smz_ipa_smz: Zooplankton switching and prey preference parameters  dimensionless !
!
! smz_ipa_mdz  smz_ipa_mdz: Zooplankton switching and prey preference parameters  dimensionless !
!
! smz_ipa_lgz  smz_ipa_lgz: Zooplankton switching and prey preference parameters  dimensionless !
!
! smz_ipa_bact  smz_ipa_bact: Zooplankton switching and prey preference parameters  dimensionless !
!
! smz_ipa_det  smz_ipa_det: Zooplankton switching and prey preference parameters  dimensionless !
!
! mdz_ipa_smp  mdz_ipa_smp: Zooplankton switching and prey preference parameters  dimensionless !
!
! mdz_ipa_lgp  mdz_ipa_lgp: Zooplankton switching and prey preference parameters  dimensionless !
!
! mdz_ipa_diaz  mdz_ipa_diaz: Zooplankton switching and prey preference parameters  dimensionless !
!
! mdz_ipa_smz  mdz_ipa_smz: Zooplankton switching and prey preference parameters  dimensionless !
!
! mdz_ipa_mdz  mdz_ipa_mdz: Zooplankton switching and prey preference parameters  dimensionless !
!
! mdz_ipa_lgz  mdz_ipa_lgz: Zooplankton switching and prey preference parameters  dimensionless !
!
! mdz_ipa_bact  mdz_ipa_bact: Zooplankton switching and prey preference parameters  dimensionless !
!
! mdz_ipa_det  mdz_ipa_det: Zooplankton switching and prey preference parameters  dimensionless !
!
! lgz_ipa_smp  lgz_ipa_smp: Zooplankton switching and prey preference parameters  dimensionless !
!
! lgz_ipa_lgp  lgz_ipa_lgp: Zooplankton switching and prey preference parameters  dimensionless !
!
! lgz_ipa_diaz  lgz_ipa_diaz: Zooplankton switching and prey preference parameters  dimensionless !
!
! lgz_ipa_smz  lgz_ipa_smz: Zooplankton switching and prey preference parameters  dimensionless !
!
! lgz_ipa_mdz  lgz_ipa_mdz: Zooplankton switching and prey preference parameters  dimensionless !
!
! lgz_ipa_lgz  lgz_ipa_lgz: Zooplankton switching and prey preference parameters  dimensionless !
!
! lgz_ipa_bact  lgz_ipa_bact: Zooplankton switching and prey preference parameters  dimensionless !
!
! lgz_ipa_det  lgz_ipa_det: Zooplankton switching and prey preference parameters  dimensionless !
!
! gge_max_smz  gge_max_smz: Zooplankton bioenergetics  dimensionless !
!
! gge_max_mdz  gge_max_mdz: Zooplankton bioenergetics  dimensionless !
!
! gge_max_lgz  gge_max_lgz: Zooplankton bioenergetics  dimensionless !
!
! bresp_smz  bresp_smz: Zooplankton bioenergetics  s-1 !
!
! bresp_mdz  bresp_mdz: Zooplankton bioenergetics  s-1 !
!
! bresp_lgz  bresp_lgz: Zooplankton bioenergetics  s-1 !
!
! gge_max_bact  gge_max_bact: Bacterial bioenergetics  dimensionless !
!
! bresp_bact  bresp_bact: Bacterial bioenergetics  s-1 !
!
! phi_det_smz  phi_det_smz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_det_mdz  phi_det_mdz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_det_lgz  phi_det_lgz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_ldon_smz  phi_ldon_smz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_ldon_mdz  phi_ldon_mdz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_ldon_lgz  phi_ldon_lgz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_ldop_smz  phi_ldop_smz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_ldop_mdz  phi_ldop_mdz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_ldop_lgz  phi_ldop_lgz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_srdon_smz  phi_srdon_smz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_srdon_mdz  phi_srdon_mdz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_srdon_lgz  phi_srdon_lgz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_srdop_smz  phi_srdop_smz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_srdop_mdz  phi_srdop_mdz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_srdop_lgz  phi_srdop_lgz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_sldon_smz  phi_sldon_smz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_sldon_mdz  phi_sldon_mdz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_sldon_lgz  phi_sldon_lgz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_sldop_smz  phi_sldop_smz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_sldop_mdz  phi_sldop_mdz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_sldop_lgz  phi_sldop_lgz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_nh4_smz  phi_nh4_smz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_nh4_mdz  phi_nh4_mdz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_nh4_lgz  phi_nh4_lgz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_po4_smz  phi_po4_smz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_po4_mdz  phi_po4_mdz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_po4_lgz  phi_po4_lgz: Partitioning of zooplankton ingestion to other compartments  dimensionless !
!
! phi_ldon_vir  phi_ldon_vir: Partitioning of viral losses to various dissolved pools  dimensionless !
!
! phi_srdon_vir  phi_srdon_vir: Partitioning of viral losses to various dissolved pools  dimensionless !
!
! phi_sldon_vir  phi_sldon_vir: Partitioning of viral losses to various dissolved pools  dimensionless !
!
! phi_ldop_vir  phi_ldop_vir: Partitioning of viral losses to various dissolved pools  dimensionless !
!
! phi_srdop_vir  phi_srdop_vir: Partitioning of viral losses to various dissolved pools  dimensionless !
!
! phi_sldop_vir  phi_sldop_vir: Partitioning of viral losses to various dissolved pools  dimensionless !
!
! imax_hp  imax_hp: Parameters for unresolved higher predators  s-1 !
!
! ki_hp  ki_hp: Parameters for unresolved higher predators  mol N kg-1 !
!
! coef_hp  coef_hp: Parameters for unresolved higher predators  dimensionless !
!
! ktemp_hp  ktemp_hp: Parameters for unresolved higher predators  C-1 !
!
! nswitch_hp  nswitch_hp: Parameters for unresolved higher predators  dimensionless !
!
! mswitch_hp  mswitch_hp: Parameters for unresolved higher predators  dimensionless !
!
! hp_ipa_smp  hp_ipa_smp: Parameters for unresolved higher predators  dimensionless !
!
! hp_ipa_lgp  hp_ipa_lgp: Parameters for unresolved higher predators  dimensionless !
!
! hp_ipa_diaz  hp_ipa_diaz: Parameters for unresolved higher predators  dimensionless !
!
! hp_ipa_smz  hp_ipa_smz: Parameters for unresolved higher predators  dimensionless !
!
! hp_ipa_mdz  hp_ipa_mdz: Parameters for unresolved higher predators  dimensionless !
!
! hp_ipa_lgz  hp_ipa_lgz: Parameters for unresolved higher predators  dimensionless !
!
! hp_ipa_bact  hp_ipa_bact: Parameters for unresolved higher predators  dimensionless !
!
! hp_ipa_det  hp_ipa_det: Parameters for unresolved higher predators  dimensionless !
!
! hp_phi_det  hp_phi_det: Parameters for unresolved higher predators  dimensionless !
!
! hp_phi_ldon  hp_phi_ldon: Parameters for unresolved higher predators  dimensionless !
!
! hp_phi_ldop  hp_phi_ldop: Parameters for unresolved higher predators  dimensionless !
!
! hp_phi_srdon  hp_phi_srdon: Parameters for unresolved higher predators  dimensionless !
!
! hp_phi_srdop  hp_phi_srdop: Parameters for unresolved higher predators  dimensionless !
!
! hp_phi_sldon  hp_phi_sldon: Parameters for unresolved higher predators  dimensionless !
!
! hp_phi_sldop  hp_phi_sldop: Parameters for unresolved higher predators  dimensionless !
!
! hp_phi_nh4  hp_phi_nh4: Parameters for unresolved higher predators  dimensionless !
!
! hp_phi_po4  hp_phi_po4: Parameters for unresolved higher predators  dimensionless !
!
! felig_bkg  felig_bkg: Iron chemistry  mol Fe kg-1 !
!
! felig_2_don  felig_2_don: Iron chemistry  mol Fe mol N-1 !
!
! fe_2_n_sed  fe_2_n_sed: Iron chemistry  mol Fe mol N-1 !
!
! fe_coast  fe_coast: Iron chemistry  mol Fe m kg-1 s-1 !
!
! alpha_fescav  alpha_fescav: Iron chemistry  sec-1 !
!
! beta_fescav  beta_fescav: Iron chemistry  mol N-1 sec-1 !
!
! remin_eff_fedet  remin_eff_fedet: Iron chemistry  unitless !
!
! ki_fescav  ki_fescav: Iron chemistry  watts m-2 !
!
! io_fescav  io_fescav: Iron chemistry  watts m-2 !
!
! gamma_fescav  gamma_fescav: Iron chemistry  watts m-2 !
!
! kfe_eq_lig_ll  kfe_eq_lig_ll: Iron chemistry  mol lig-1 kg !
!
! kfe_eq_lig_hl  kfe_eq_lig_hl: Iron chemistry  mol lig-1 kg !
!
! k_o2  k_o2: Remineralization  mol O2 kg-1 !
!
! o2_min  o2_min: Remineralization  mol O2 kg-1 !
!
! rpcaco3  rpcaco3: Remineralization  mol N mol Ca-1 !
!
! rplith  rplith: Remineralization  mol N g lith-1 !
!
! rpsio2  rpsio2: Remineralization  mol N mol Si-1 !
!
! gamma_ndet  gamma_ndet: Remineralization  s-1 !
!
! gamma_cadet_arag  gamma_cadet_arag: Remineralization  s-1 !
!
! gamma_cadet_calc  gamma_cadet_calc: Remineralization  s-1 !
!
! gamma_sidet  gamma_sidet: Remineralization  s-1 !
!
! phi_lith  phi_lith: Remineralization  kg mol-1 !
!
! k_lith  k_lith: Remineralization  s-1 !
!
! z_sed  z_sed: Remineralization  m !
!
! k_no3_denit  k_no3_denit: Remineralization  mol NO3 kg-1 !
!
! gamma_srdon  gamma_srdon: Dissolved Organic Material  s-1 !
!
! gamma_srdop  gamma_srdop: Dissolved Organic Material  s-1 !
!
! gamma_sldon  gamma_sldon: Dissolved Organic Material  s-1 !
!
! gamma_sldop  gamma_sldop: Dissolved Organic Material  s-1 !
!
! gamma_nitrif  gamma_nitrif: Nitrification  s-1 !
!
! irr_inhibit  irr_inhibit: Nitrification  m2 W-1 !
!
! tracer_debug  tracer_debug: MISC  N/A !
!
! htotal_in  htotal_in: ?  N/A !
!
! wsink  wsink: Sinking velocity of detritus  m s-1 !
!
! ice_restart_file  ice_restart_file: ice restart file  N/A !
!
! ocean_restart_file  ocean_restart_file: ocean restart file  N/A !
!
! IC_file  IC_file: Initial conditions  N/A !
!
!=======================================================================
!
      USE mod_param

      implicit none
!
!  Set biological tracer identification indices.
!  These are used to identify the variable in the tracer array of ROMS
!

      integer, allocatable :: idbio(:)    ! Biological tracers
      integer, allocatable :: iDbio2(:)   ! 2D diag Biological tracers
      integer, allocatable :: iDbio3(:)   ! 3D diag Biological tracers
      integer, allocatable :: idsink(:)   ! Sinking material
#if defined BENTHIC
      integer, allocatable :: NBeT(:)
      integer              :: NBEN
      integer, allocatable :: idben(:)    ! Benthic tracers
      integer, allocatable :: rstBid(:,:)
      integer, allocatable :: idBeTvar(:)
      integer, allocatable :: hisBid(:,:)
      integer, allocatable :: avgBid(:,:)
#endif
! RD : needs CPP keys ?
      integer              :: ialk        ! Alkalinity
      integer              :: icadet_arag ! Detrital CaCO3
      integer              :: icadet_calc ! Detrital CaCO3
      integer              :: idic        ! Dissolved Inorganic Carbon
      integer              :: ifed        ! Dissolved Iron
      integer              :: ifedet      ! Detrital Iron
      integer              :: ifedi       ! Diazotroph Iron
      integer              :: ifelg       ! Large Phytoplankton Iron
      integer              :: ifesm       ! Small Phytoplankton Iron
      integer              :: ildon       ! labile DON
      integer              :: ildop       ! labile DOP
      integer              :: ilith       ! Lithogenic Aluminosilicate
      integer              :: ilithdet    ! lithdet
      integer              :: inbact      ! bacterial
      integer              :: indet       ! ndet
      integer              :: indi        ! Diazotroph Nitrogen
      integer              :: inlg        ! Large Phytoplankton Nitrogen
      integer              :: insm        ! Small Phytoplankton Nitrogen
      integer              :: inh4        ! Ammonia
      integer              :: ino3        ! Nitrate
      integer              :: io2         ! Oxygen
      integer              :: ipdet       ! Detrital Phosphorus
      integer              :: ipo4        ! Phosphate
      integer              :: isrdon      ! Semi-Refractory DON
      integer              :: isrdop      ! Semi-Refractory DOP
      integer              :: isldon      ! Semilabile DON
      integer              :: isldop      ! Semilabile DOP
      integer              :: isidet      ! Detrital Silicon
      integer              :: isilg       ! Large Phytoplankton Silicon
      integer              :: isio4       ! Silicate
      integer              :: insmz       ! Small Zooplankton Nitrogen
      integer              :: inmdz       ! Medium-sized zooplankton Nitrogen
      integer              :: inlgz       ! large Zooplankton Nitrogen

      integer              :: Nsink

      ! Diagnostic variables
      integer :: icased ! Sediment CaCO3
      integer :: ichl ! Chlorophyll
      integer :: ico3_ion ! Carbonate ion
      integer :: icadet_arag_btf ! aragonite flux to Sediments
      integer :: icadet_calc_btf ! calcite flux to Sediments
      integer :: indet_btf ! N flux to Sediments
      integer :: ipdet_btf ! P flux to Sediments
      integer :: isidet_btf ! SiO2 flux to Sediments
      integer :: imxl_depth ! mixed layer
      integer :: imxl_level ! mixed layer
      integer :: ialk_btf
      integer :: idic_btf
      integer :: ifed_btf
      integer :: inh4_btf
      integer :: ino3_btf
      integer :: io2_btf
      integer :: ipo4_btf
      integer :: isio4_btf
      integer :: ihtotal ! H+ ion concentration
      integer :: iirr_mem ! Irradiance memory
      integer :: iirr_mix ! Irradiance in MXL
      integer :: iirr_inst ! Irradiance instantaneous
      integer :: ijprod_cadet_arag, ijprod_cadet_calc, ijprod_fedet
      integer :: ijprod_lithdet, ijprod_ndet, ijprod_pdet, ijprod_sidet
      integer :: indet_b4sink, ipdet_b4sink, ifedet_b4sink
      integer :: indet_afsink, ipdet_afsink, ifedet_afsink
      integer :: indet_btm
      integer :: indet_flx
      integer :: ijdiss_cadet_arag
      integer :: ijdiss_cadet_calc
      integer :: iomega_cadet_arag
      integer :: iomega_cadet_calc
      integer :: ijremin_ndet
      integer :: ijremin_pdet
      integer :: ijremin_fedet
      integer :: idet_jzloss_n
      integer :: idet_jzloss_p
      integer :: idet_jzloss_fe
      integer :: idet_jhploss_n
      integer :: idet_jhploss_p
      integer :: idet_jhploss_fe
      integer :: ico3_sol_arag
      integer :: ico3_sol_calc
      integer :: ife_bulk_flx
      integer :: ijprod_ndet_100
      integer :: ijremin_ndet_100
      integer :: ialpha, ico2star,ipco2surf, ico2_flx, io2_flx
      integer :: iironsed_flx
      integer :: iswdk

      integer :: ipCO2=-99999 ! is never used, for compatibility issues

! Biological Parameters read in the bio_cobalt.in

      integer, allocatable  :: BioIter(:)
      !real(r8), allocatable :: init(:)                       ! N/A
      real(r8), allocatable :: htotal_scale_lo(:)            ! N/A
      real(r8), allocatable :: htotal_scale_hi(:)            ! N/A
      real(r8), allocatable :: RHO_0(:)                      ! N/A
      integer,  allocatable :: NKML(:)                       ! N/A
      real(r8), allocatable :: a_0(:)                        ! N/A
      real(r8), allocatable :: a_1(:)                        ! N/A
      real(r8), allocatable :: a_2(:)                        ! N/A
      real(r8), allocatable :: a_3(:)                        ! N/A
      real(r8), allocatable :: a_4(:)                        ! N/A
      real(r8), allocatable :: a_5(:)                        ! N/A
      real(r8), allocatable :: b_0(:)                        ! N/A
      real(r8), allocatable :: b_1(:)                        ! N/A
      real(r8), allocatable :: b_2(:)                        ! N/A
      real(r8), allocatable :: b_3(:)                        ! N/A
      real(r8), allocatable :: c_0(:)                        ! N/A
      real(r8), allocatable :: a1_co2(:)                     ! N/A
      real(r8), allocatable :: a2_co2(:)                     ! N/A
      real(r8), allocatable :: a3_co2(:)                     ! N/A
      real(r8), allocatable :: a4_co2(:)                     ! N/A
      real(r8), allocatable :: a1_o2(:)                      ! N/A
      real(r8), allocatable :: a2_o2(:)                      ! N/A
      real(r8), allocatable :: a3_o2(:)                      ! N/A
      real(r8), allocatable :: a4_o2(:)                      ! N/A
      real(r8), allocatable :: mass_2_n(:)                   ! g mol N-1
      real(r8), allocatable :: n_2_n_denit(:)                ! mol N NO3 mol N org-1
      real(r8), allocatable :: o2_2_c(:)                     ! mol O2 mol C-1
      real(r8), allocatable :: o2_2_nfix(:)                  ! mol O2 mol N-1
      real(r8), allocatable :: o2_2_nh4(:)                   ! mol O2 mol N-1
      real(r8), allocatable :: o2_2_nitrif(:)                ! mol O2 mol N-1
      real(r8), allocatable :: o2_2_no3(:)                   ! mol O2 mol N-1
      real(r8), allocatable :: k_fed_Di(:)                   ! mol Fed kg-1
      real(r8), allocatable :: k_fed_Lg(:)                   ! mol Fed kg-1
      real(r8), allocatable :: k_fed_Sm(:)                   ! mol Fed kg-1
      real(r8), allocatable :: k_nh4_Lg(:)                   ! mol NH4 kg-1
      real(r8), allocatable :: k_nh4_Sm(:)                   ! mol NH4 kg-1
      real(r8), allocatable :: k_nh4_Di(:)                   ! mol NH4 kg-1
      real(r8), allocatable :: k_no3_Lg(:)                   ! mol NO3 kg-1
      real(r8), allocatable :: k_no3_Sm(:)                   ! mol NO3 kg-1
      real(r8), allocatable :: k_no3_Di(:)                   ! mol NO3 kg-1
      real(r8), allocatable :: k_po4_Di(:)                   ! mol PO4 kg-1
      real(r8), allocatable :: k_po4_Lg(:)                   ! mol PO4 kg-1
      real(r8), allocatable :: k_po4_Sm(:)                   ! mol PO4 kg-1
      real(r8), allocatable :: k_sio4_Lg(:)                  ! mol SiO4 kg-1
      real(r8), allocatable :: k_fe_2_n_Di(:)                ! mol Fe mol N-1
      real(r8), allocatable :: k_fe_2_n_Lg(:)                ! mol Fe mol N-1
      real(r8), allocatable :: k_fe_2_n_Sm(:)                ! mol Fe mol N-1
      real(r8), allocatable :: fe_2_n_max_Sm(:)              ! mol Fe mol N-1
      real(r8), allocatable :: fe_2_n_max_Lg(:)              ! mol Fe mol N-1
      real(r8), allocatable :: fe_2_n_max_Di(:)              ! mol Fe mol N-1
      real(r8), allocatable :: fe_2_n_upt_fac(:)             ! mol Fe mol N-1
      real(r8), allocatable :: alpha_Di(:)                   ! g C g Chl-1 m2 W-1 s-1
      real(r8), allocatable :: alpha_Lg(:)                   ! g C g Chl-1 m2 W-1 s-1
      real(r8), allocatable :: alpha_Sm(:)                   ! g C g Chl-1 m2 W-1 s-1
      real(r8), allocatable :: kappa_eppley(:)               ! deg C-1
      real(r8), allocatable :: P_C_max_Di(:)                 ! s-1
      real(r8), allocatable :: P_C_max_Lg(:)                 ! s-1
      real(r8), allocatable :: P_C_max_Sm(:)                 ! s-1
      real(r8), allocatable :: thetamax_Di(:)                ! g Chl g C-1
      real(r8), allocatable :: thetamax_Lg(:)                ! g Chl g C-1
      real(r8), allocatable :: thetamax_Sm(:)                ! g Chl g C-1
      real(r8), allocatable :: bresp_Di(:)                   ! sec-1
      real(r8), allocatable :: bresp_Lg(:)                   ! sec-1
      real(r8), allocatable :: bresp_Sm(:)                   ! sec-1
      real(r8), allocatable :: thetamin(:)                   ! g Chl g C-1
      real(r8), allocatable :: thetamin_nolim(:)             ! g Chl g C-1
      real(r8), allocatable :: zpllgr(:)                     ! dimensionless
      real(r8), allocatable :: gamma_irr_mem(:)              ! s-1
      real(r8), allocatable :: k_n_inhib_Di(:)               ! mol NO3 kg-1
      real(r8), allocatable :: o2_inhib_Di_pow(:)            ! mol O2-1 m3
      real(r8), allocatable :: o2_inhib_Di_sat(:)            ! mol O2 kg-1
      integer,  allocatable :: p_2_n_static(:)               ! N/A
      real(r8), allocatable :: c_2_n(:)                      ! N/A
      real(r8), allocatable :: alk_2_n_denit(:)              ! eq. alk mol NO3-1
      real(r8), allocatable :: p_2_n_static_Di(:)            ! mol P mol N-1
      real(r8), allocatable :: p_2_n_static_Lg(:)            ! mol P mol N-1
      real(r8), allocatable :: p_2_n_static_Sm(:)            ! mol P mol N-1
      real(r8), allocatable :: si_2_n_static_Lg(:)           ! mol Si mol N-1
      real(r8), allocatable :: si_2_n_max_Lg(:)              ! mol Si mol N-1
      real(r8), allocatable :: ca_2_n_arag(:)                ! mol Ca mol N-1
      real(r8), allocatable :: ca_2_n_calc(:)                ! mol Ca mol N-1
      real(r8), allocatable :: caco3_sat_max(:)              ! dimensionless
      real(r8), allocatable :: q_p_2_n_smz(:)                ! mol P mol N-1
      real(r8), allocatable :: q_p_2_n_mdz(:)                ! mol P mol N-1
      real(r8), allocatable :: q_p_2_n_lgz(:)                ! mol P mol N-1
      real(r8), allocatable :: q_p_2_n_bact(:)               ! mol P mol N-1
      real(r8), allocatable :: agg_Sm(:)                     ! s-1 (mole N kg)-1
      real(r8), allocatable :: agg_Di(:)                     ! s-1 (mole N kg)-1
      real(r8), allocatable :: agg_Lg(:)                     ! s-1 (mole N kg)-1
      real(r8), allocatable :: vir_Sm(:)                     ! s-1 (mole N kg)-1
      real(r8), allocatable :: vir_Di(:)                     ! s-1 (mole N kg)-1
      real(r8), allocatable :: vir_Lg(:)                     ! s-1 (mole N kg)-1
      real(r8), allocatable :: vir_Bact(:)                   ! s-1 (mole N kg)-1
      real(r8), allocatable :: ktemp_vir(:)                  ! C-1
      real(r8), allocatable :: exu_Sm(:)                     ! dimensionless (fraction of NPP)
      real(r8), allocatable :: exu_Di(:)                     ! dimensionless (fraction of NPP)
      real(r8), allocatable :: exu_Lg(:)                     ! dimensionless (fraction of NPP)
      real(r8), allocatable :: imax_smz(:)                   ! s-1
      real(r8), allocatable :: imax_mdz(:)                   ! s-1
      real(r8), allocatable :: imax_lgz(:)                   ! s-1
      real(r8), allocatable :: ki_smz(:)                     ! moles N kg-1
      real(r8), allocatable :: ki_mdz(:)                     ! moles N kg-1
      real(r8), allocatable :: ki_lgz(:)                     ! moles N kg-1
      real(r8), allocatable :: ktemp_smz(:)                  ! C-1
      real(r8), allocatable :: ktemp_mdz(:)                  ! C-1
      real(r8), allocatable :: ktemp_lgz(:)                  ! C-1
      real(r8), allocatable :: mu_max_bact(:)                ! s-1
      real(r8), allocatable :: k_ldon_bact(:)                ! mol ldon kg-1
      real(r8), allocatable :: ktemp_bact(:)                 ! C-1
      real(r8), allocatable :: nswitch_smz(:)                ! dimensionless
      real(r8), allocatable :: nswitch_mdz(:)                ! dimensionless
      real(r8), allocatable :: nswitch_lgz(:)                ! dimensionless
      real(r8), allocatable :: mswitch_smz(:)                ! dimensionless
      real(r8), allocatable :: mswitch_mdz(:)                ! dimensionless
      real(r8), allocatable :: mswitch_lgz(:)                ! dimensionless
      real(r8), allocatable :: smz_ipa_smp(:)                ! dimensionless
      real(r8), allocatable :: smz_ipa_lgp(:)                ! dimensionless
      real(r8), allocatable :: smz_ipa_diaz(:)               ! dimensionless
      real(r8), allocatable :: smz_ipa_smz(:)                ! dimensionless
      real(r8), allocatable :: smz_ipa_mdz(:)                ! dimensionless
      real(r8), allocatable :: smz_ipa_lgz(:)                ! dimensionless
      real(r8), allocatable :: smz_ipa_bact(:)               ! dimensionless
      real(r8), allocatable :: smz_ipa_det(:)                ! dimensionless
      real(r8), allocatable :: mdz_ipa_smp(:)                ! dimensionless
      real(r8), allocatable :: mdz_ipa_lgp(:)                ! dimensionless
      real(r8), allocatable :: mdz_ipa_diaz(:)               ! dimensionless
      real(r8), allocatable :: mdz_ipa_smz(:)                ! dimensionless
      real(r8), allocatable :: mdz_ipa_mdz(:)                ! dimensionless
      real(r8), allocatable :: mdz_ipa_lgz(:)                ! dimensionless
      real(r8), allocatable :: mdz_ipa_bact(:)               ! dimensionless
      real(r8), allocatable :: mdz_ipa_det(:)                ! dimensionless
      real(r8), allocatable :: lgz_ipa_smp(:)                ! dimensionless
      real(r8), allocatable :: lgz_ipa_lgp(:)                ! dimensionless
      real(r8), allocatable :: lgz_ipa_diaz(:)               ! dimensionless
      real(r8), allocatable :: lgz_ipa_smz(:)                ! dimensionless
      real(r8), allocatable :: lgz_ipa_mdz(:)                ! dimensionless
      real(r8), allocatable :: lgz_ipa_lgz(:)                ! dimensionless
      real(r8), allocatable :: lgz_ipa_bact(:)               ! dimensionless
      real(r8), allocatable :: lgz_ipa_det(:)                ! dimensionless
      real(r8), allocatable :: gge_max_smz(:)                ! dimensionless
      real(r8), allocatable :: gge_max_mdz(:)                ! dimensionless
      real(r8), allocatable :: gge_max_lgz(:)                ! dimensionless
      real(r8), allocatable :: bresp_smz(:)                  ! s-1
      real(r8), allocatable :: bresp_mdz(:)                  ! s-1
      real(r8), allocatable :: bresp_lgz(:)                  ! s-1
      real(r8), allocatable :: gge_max_bact(:)               ! dimensionless
      real(r8), allocatable :: bresp_bact(:)                 ! s-1
      real(r8), allocatable :: phi_det_smz(:)                ! dimensionless
      real(r8), allocatable :: phi_det_mdz(:)                ! dimensionless
      real(r8), allocatable :: phi_det_lgz(:)                ! dimensionless
      real(r8), allocatable :: phi_ldon_smz(:)               ! dimensionless
      real(r8), allocatable :: phi_ldon_mdz(:)               ! dimensionless
      real(r8), allocatable :: phi_ldon_lgz(:)               ! dimensionless
      real(r8), allocatable :: phi_ldop_smz(:)               ! dimensionless
      real(r8), allocatable :: phi_ldop_mdz(:)               ! dimensionless
      real(r8), allocatable :: phi_ldop_lgz(:)               ! dimensionless
      real(r8), allocatable :: phi_srdon_smz(:)              ! dimensionless
      real(r8), allocatable :: phi_srdon_mdz(:)              ! dimensionless
      real(r8), allocatable :: phi_srdon_lgz(:)              ! dimensionless
      real(r8), allocatable :: phi_srdop_smz(:)              ! dimensionless
      real(r8), allocatable :: phi_srdop_mdz(:)              ! dimensionless
      real(r8), allocatable :: phi_srdop_lgz(:)              ! dimensionless
      real(r8), allocatable :: phi_sldon_smz(:)              ! dimensionless
      real(r8), allocatable :: phi_sldon_mdz(:)              ! dimensionless
      real(r8), allocatable :: phi_sldon_lgz(:)              ! dimensionless
      real(r8), allocatable :: phi_sldop_smz(:)              ! dimensionless
      real(r8), allocatable :: phi_sldop_mdz(:)              ! dimensionless
      real(r8), allocatable :: phi_sldop_lgz(:)              ! dimensionless
      real(r8), allocatable :: phi_nh4_smz(:)                ! dimensionless
      real(r8), allocatable :: phi_nh4_mdz(:)                ! dimensionless
      real(r8), allocatable :: phi_nh4_lgz(:)                ! dimensionless
      real(r8), allocatable :: phi_po4_smz(:)                ! dimensionless
      real(r8), allocatable :: phi_po4_mdz(:)                ! dimensionless
      real(r8), allocatable :: phi_po4_lgz(:)                ! dimensionless
      real(r8), allocatable :: phi_ldon_vir(:)               ! dimensionless
      real(r8), allocatable :: phi_srdon_vir(:)              ! dimensionless
      real(r8), allocatable :: phi_sldon_vir(:)              ! dimensionless
      real(r8), allocatable :: phi_ldop_vir(:)               ! dimensionless
      real(r8), allocatable :: phi_srdop_vir(:)              ! dimensionless
      real(r8), allocatable :: phi_sldop_vir(:)              ! dimensionless
      real(r8), allocatable :: imax_hp(:)                    ! s-1
      real(r8), allocatable :: ki_hp(:)                      ! mol N kg-1
      real(r8), allocatable :: coef_hp(:)                    ! dimensionless
      real(r8), allocatable :: ktemp_hp(:)                   ! C-1
      real(r8), allocatable :: nswitch_hp(:)                 ! dimensionless
      real(r8), allocatable :: mswitch_hp(:)                 ! dimensionless
      real(r8), allocatable :: hp_ipa_smp(:)                 ! dimensionless
      real(r8), allocatable :: hp_ipa_lgp(:)                 ! dimensionless
      real(r8), allocatable :: hp_ipa_diaz(:)                ! dimensionless
      real(r8), allocatable :: hp_ipa_smz(:)                 ! dimensionless
      real(r8), allocatable :: hp_ipa_mdz(:)                 ! dimensionless
      real(r8), allocatable :: hp_ipa_lgz(:)                 ! dimensionless
      real(r8), allocatable :: hp_ipa_bact(:)                ! dimensionless
      real(r8), allocatable :: hp_ipa_det(:)                 ! dimensionless
      real(r8), allocatable :: hp_phi_det(:)                 ! dimensionless
      real(r8), allocatable :: hp_phi_ldon(:)                ! dimensionless
      real(r8), allocatable :: hp_phi_ldop(:)                ! dimensionless
      real(r8), allocatable :: hp_phi_srdon(:)               ! dimensionless
      real(r8), allocatable :: hp_phi_srdop(:)               ! dimensionless
      real(r8), allocatable :: hp_phi_sldon(:)               ! dimensionless
      real(r8), allocatable :: hp_phi_sldop(:)               ! dimensionless
      real(r8), allocatable :: hp_phi_nh4(:)                 ! dimensionless
      real(r8), allocatable :: hp_phi_po4(:)                 ! dimensionless
      real(r8), allocatable :: felig_bkg(:)                  ! mol Fe kg-1
      real(r8), allocatable :: felig_2_don(:)                ! mol Fe mol N-1
      real(r8), allocatable :: fe_2_n_sed(:)                 ! mol Fe mol N-1
      real(r8), allocatable :: fe_coast(:)                   ! mol Fe m kg-1 s-1
      real(r8), allocatable :: alpha_fescav(:)               ! sec-1
      real(r8), allocatable :: beta_fescav(:)                ! mol N-1 sec-1
      real(r8), allocatable :: remin_eff_fedet(:)            ! unitless
      real(r8), allocatable :: ki_fescav(:)                  ! watts m-2
      real(r8), allocatable :: io_fescav(:)                  ! watts m-2
      real(r8), allocatable :: gamma_fescav(:)               ! watts m-2
      real(r8), allocatable :: kfe_eq_lig_ll(:)              ! mol lig-1 kg
      real(r8), allocatable :: kfe_eq_lig_hl(:)              ! mol lig-1 kg
      real(r8), allocatable :: k_o2(:)                       ! mol O2 kg-1
      real(r8), allocatable :: o2_min(:)                     ! mol O2 kg-1
      real(r8), allocatable :: rpcaco3(:)                    ! mol N mol Ca-1
      real(r8), allocatable :: rplith(:)                     ! mol N g lith-1
      real(r8), allocatable :: rpsio2(:)                     ! mol N mol Si-1
      real(r8), allocatable :: gamma_ndet(:)                 ! s-1
      real(r8), allocatable :: gamma_cadet_arag(:)           ! s-1
      real(r8), allocatable :: gamma_cadet_calc(:)           ! s-1
      real(r8), allocatable :: gamma_sidet(:)                ! s-1
      real(r8), allocatable :: phi_lith(:)                   ! kg mol-1
      real(r8), allocatable :: k_lith(:)                     ! s-1
      real(r8), allocatable :: z_sed(:)                      ! m
      real(r8), allocatable :: k_no3_denit(:)                ! mol NO3 kg-1
      real(r8), allocatable :: gamma_srdon(:)                ! s-1
      real(r8), allocatable :: gamma_srdop(:)                ! s-1
      real(r8), allocatable :: gamma_sldon(:)                ! s-1
      real(r8), allocatable :: gamma_sldop(:)                ! s-1
      real(r8), allocatable :: gamma_nitrif(:)               ! s-1
      real(r8), allocatable :: irr_inhibit(:)                ! m2 W-1
      !real(r8), allocatable :: tracer_debug(:)               ! N/A
      real(r8), allocatable :: htotal_in(:)                  ! N/A
      real(r8), allocatable :: wsink(:)                      ! m s-1
      !real(r8), allocatable :: ice_restart_file(:)           ! N/A
      !real(r8), allocatable :: ocean_restart_file(:)         ! N/A
      !real(r8), allocatable :: IC_file(:)                    ! N/A

! Cobalt parameters

     real, parameter :: sperd = 24.0 * 3600.0
     real, parameter :: spery = 365.25 * sperd
     real, parameter :: epsln=1.0e-30
     real, parameter :: missing_value1=-1.0e+10
     real, parameter :: missing_value_diag=-1.0e+10

! ---------------------------------------------------------------------
! Declare Cobalt types
! ---------------------------------------------------------------------
!

! Declare phytoplankton, zooplankton and cobalt variable types, which
! contain the vast majority of all variables used in this module.

      type phytoplankton
     real(8) :: alpha,      &
          fe_2_n_max,    &
          p_2_n_static,  &
          k_fe_2_n,      &
          k_fed,         &
          k_nh4,         &
          k_no3,         &
          k_po4,         &
          k_sio4,        &
          P_C_max,       &
          si_2_n_max,    &
          si_2_n_static, &
          thetamax,      &
          bresp,         &
          agg,           &
          vir,           &
          exu
     real(8), ALLOCATABLE, dimension(:,:)  :: &
          jprod_n_100,      &
          jprod_n_new_100,  &
          jprod_n_n2_100,   &
          jzloss_n_100,     &
          jaggloss_n_100,   &
          jvirloss_n_100,   &
          jexuloss_n_100,   &
          f_n_100
     real(8), ALLOCATABLE, dimension(:,:,:)  :: &
          def_fe      , &
          def_p       , &
          f_fe        , &
          f_n         , &
          felim       , &
          irrlim      , &
          jzloss_fe   , &
          jzloss_n    , &
          jzloss_p    , &
          jzloss_sio2 , &
          jaggloss_fe , &
          jaggloss_n  , &
          jaggloss_p  , &
          jaggloss_sio2,&
          jvirloss_fe , &
          jvirloss_n  , &
          jvirloss_p  , &
          jvirloss_sio2,&
          jexuloss_fe , &
          jexuloss_n  , &
          jexuloss_p  , &
          jhploss_fe  , &
          jhploss_n   , &
          jhploss_p   , &
          jhploss_sio2, &
          juptake_n2  , &
          juptake_fe  , &
          juptake_nh4 , &
          juptake_no3 , &
          juptake_po4 , &
          juptake_sio4, &
          jprod_n     , &
          liebig_lim  , &
          mu          , &
          nh4lim      , &
          no3lim      , &
          po4lim      , &
          o2lim       , &
          q_fe_2_n    , &
          q_p_2_n     , &
          silim       , &
          q_si_2_n    , &
          theta
      integer ::            &
          id_def_fe       = -1, &
          id_def_p        = -1, &
          id_felim        = -1, &
          id_irrlim       = -1, &
          id_jzloss_fe    = -1, &
          id_jzloss_n     = -1, &
          id_jzloss_p     = -1, &
          id_jzloss_sio2  = -1, &
          id_jaggloss_fe  = -1, &
          id_jaggloss_n   = -1, &
          id_jaggloss_p   = -1, &
          id_jaggloss_sio2= -1, &
          id_jvirloss_fe  = -1, &
          id_jvirloss_n   = -1, &
          id_jvirloss_p   = -1, &
          id_jvirloss_sio2= -1, &
          id_jexuloss_n   = -1, &
          id_jexuloss_p   = -1, &
          id_jexuloss_fe  = -1, &
          id_jhploss_fe   = -1, &
          id_jhploss_n    = -1, &
          id_jhploss_p    = -1, &
          id_jhploss_sio2 = -1, &
          id_juptake_n2   = -1, &
          id_juptake_fe   = -1, &
          id_juptake_nh4  = -1, &
          id_juptake_no3  = -1, &
          id_juptake_po4  = -1, &
          id_juptake_sio4 = -1, &
          id_jprod_n      = -1, &
          id_liebig_lim   = -1, &
          id_mu           = -1, &
          id_nh4lim       = -1, &
          id_no3lim       = -1, &
          id_po4lim       = -1, &
          id_o2lim        = -1, &
          id_q_fe_2_n     = -1, &
          id_q_p_2_n      = -1, &
          id_silim        = -1, &
          id_q_si_2_n     = -1, &
          id_theta        = -1, &
          id_jprod_n_100  = -1, &
          id_jprod_n_new_100  = -1, &
          id_jprod_n_n2_100 = -1, &
          id_jzloss_n_100     = -1, &
          id_jaggloss_n_100   = -1, &
          id_jvirloss_n_100   = -1, &
          id_jexuloss_n_100   = -1, &
          id_f_n_100          = -1, &
          id_sfc_f_n          = -1, &
          id_sfc_chl          = -1, &
          id_sfc_def_fe       = -1, &
          id_sfc_felim        = -1, &
          id_sfc_q_fe_2_n     = -1, &
          id_sfc_nh4lim       = -1, &
          id_sfc_no3lim       = -1, &
          id_sfc_po4lim       = -1, &
          id_sfc_irrlim       = -1, &
          id_sfc_theta        = -1, &
          id_sfc_mu           = -1
      end type phytoplankton


! ---------------------------------------------------------------------

      type zooplankton
     real(8) ::  &
          imax,             & ! maximum ingestion rate (sec-1)
          ki,               & ! half-sat for ingestion (moles N m-3)
          gge_max,          & ! max gross growth efficiciency (approached as i >> bresp, dimensionless)
          nswitch,          & ! switching parameter (dimensionless)
          mswitch,          & ! switching parameter (dimensionless)
          bresp,            & ! basal respiration rate (sec-1)
          ktemp,            & ! temperature dependence of zooplankton rates (C-1)
          phi_det,          & ! fraction of ingested N to detritus
          phi_ldon,         & ! fraction of ingested N/P to labile don
          phi_sldon,        & ! fraction of ingested N/P to semi-labile don
          phi_srdon,        & ! fraction of ingested N/P to semi-refractory don
          phi_ldop,         & ! fraction of ingested N/P to labile dop
          phi_sldop,        & ! fraction of ingested N/P to semi-labile dop
          phi_srdop,        & ! fraction of ingested N/P to semi-refractory dop
          phi_nh4,          & ! fraction of ingested N to nh4 due to ingestion-related metabolism
          phi_po4,          & ! fraction of ingested N to po4 due to ingestion-related metabolism
          q_p_2_n,          & ! p:n ratio of zooplankton
          ipa_smp,          & ! innate prey availability of low-light adapt. small phytos
          ipa_lgp,          & ! innate prey availability of large phytoplankton
          ipa_diaz,         & ! innate prey availability of diazotrophs
          ipa_smz,          & ! innate prey availability of small zooplankton
          ipa_mdz,          & ! innate prey availability of large zooplankton
          ipa_lgz,          & ! innate prey availability of x-large zooplankton
          ipa_det,          & ! innate prey availability of detritus
          ipa_bact            ! innate prey availability for bacteria
     real(8), ALLOCATABLE, dimension(:,:)  :: &
          jprod_n_100,      &
          jingest_n_100,    &
          jzloss_n_100,     &
          jhploss_n_100,    &
          jprod_ndet_100,   &
          jprod_don_100,    &
          jremin_n_100,     &
          f_n_100
     real(8), ALLOCATABLE, dimension(:,:,:) :: &
          f_n,              & ! zooplankton biomass
          jzloss_n,         & ! Losses of n due to consumption by other zooplankton groups
          jzloss_p,         & ! Losses of p due to consumption by other zooplankton groups
          jhploss_n,        & ! Losses of n due to consumption by unresolved higher preds
          jhploss_p,        & ! Losses of p due to consumption by unresolved higher preds
          jingest_n,        & ! Total ingestion of n
          jingest_p,        & ! Total ingestion of p
          jingest_sio2,     & ! Total ingestion of silicate
          jingest_fe,       & ! Total ingestion of iron
          jprod_ndet,       & ! production of nitrogen detritus by zooplankton group
          jprod_pdet,       & ! production of phosphorous detritus by zooplankton group
          jprod_ldon,       & ! production of labile dissolved organic N by zooplankton group
          jprod_ldop,       & ! production of labile dissolved organic P by zooplankton group
          jprod_srdon,      & ! production of semi-refractory dissolved organic N by zooplankton group
          jprod_srdop,      & ! production of semi-refractory dissolved organic P by zooplankton group
          jprod_sldon,      & ! production of semi-labile dissolved organic N by zooplankton group
          jprod_sldop,      & ! production of semi-labile dissolved organic P by zooplankton group
          jprod_fedet,      & ! production of iron detritus
          jprod_fed,        & ! production of dissolved iron
          jprod_sidet,      & ! production of silica detritus
          jprod_sio4,       & ! production of silicate via rapid dissolution at surface
          jprod_po4,        & ! phosphate production by zooplankton
          jprod_nh4,        & ! ammonia production by zooplankton
          jprod_n,          & ! zooplankton production
          temp_lim            ! Temperature limitation
      integer ::              &
          id_jzloss_n       = -1, &
          id_jzloss_p       = -1, &
          id_jhploss_n      = -1, &
          id_jhploss_p      = -1, &
          id_jingest_n      = -1, &
          id_jingest_p      = -1, &
          id_jingest_sio2   = -1, &
          id_jingest_fe     = -1, &
          id_jprod_ndet     = -1, &
          id_jprod_pdet     = -1, &
          id_jprod_ldon     = -1, &
          id_jprod_ldop     = -1, &
          id_jprod_srdon    = -1, &
          id_jprod_srdop    = -1, &
          id_jprod_sldon    = -1, &
          id_jprod_sldop    = -1, &
          id_jprod_fedet    = -1, &
          id_jprod_fed      = -1, &
          id_jprod_sidet    = -1, &
          id_jprod_sio4     = -1, &
          id_jprod_po4      = -1, &
          id_jprod_nh4      = -1, &
          id_jprod_n        = -1, &
          id_temp_lim       = -1, &
          id_jprod_n_100    = -1, &
          id_jingest_n_100  = -1, &
          id_jzloss_n_100   = -1, &
          id_jhploss_n_100  = -1, &
          id_jprod_ndet_100 = -1, &
          id_jprod_don_100  = -1, &
          id_jremin_n_100   = -1, &
          id_f_n_100        = -1
      end type zooplankton

! ---------------------------------------------------------------------

      type bacteria
     real(8) ::  &
          mu_max,           & ! maximum bacterial growth rate (sec-1)
          k_ldon,           & ! half-sat for nitrogen-limited growth (mmoles N m-3)
          gge_max,          & ! max gross growth efficiciency (dimensionless)
          bresp,            & ! basal respiration rate (sec-1)
          ktemp,            & ! temperature dependence of bacterial rates (C-1)
          vir,              & ! virus-driven loss rate for bacteria (sec-1 mmole N m-3)
          q_p_2_n             ! p:n ratio for bacteria
     real(8), ALLOCATABLE, dimension(:,:)  :: &
          jprod_n_100,      &
          jzloss_n_100,     &
          jvirloss_n_100,   &
          jremin_n_100,     &
          juptake_ldon_100, &
          f_n_100
     real(8), ALLOCATABLE, dimension(:,:,:) :: &
          f_n,              & ! bacteria biomass
          jzloss_n,         & ! Losses of n due to consumption by zooplankton
          jzloss_p,         & ! Losses of p due to consumption by zooplankton
          jhploss_n,        & ! Losses of n due to consumption by unresolved higher preds
          jhploss_p,        & ! Losses of p due to consumption by unresolved higher preds
          jvirloss_n  ,     & ! nitrogen losses via viruses
          jvirloss_p  ,     & ! phosphorous losses via viruses
          juptake_ldon,     & ! Total uptake of ldon
          juptake_ldop,     & ! Total uptake of sldon
          jprod_nh4,        & ! production of ammonia bacteria
          jprod_po4,        & ! production of phosphate by bacteria
          jprod_n,          & ! bacterial production
          temp_lim            ! Temperature limitation
      integer ::              &
          id_jzloss_n       = -1, &
          id_jzloss_p       = -1, &
          id_jhploss_n      = -1, &
          id_jhploss_p      = -1, &
          id_jvirloss_n     = -1, &
          id_jvirloss_p     = -1, &
          id_juptake_ldon   = -1, &
          id_juptake_ldop   = -1, &
          id_jprod_nh4      = -1, &
          id_jprod_po4      = -1, &
          id_jprod_n        = -1, &
          id_temp_lim       = -1, &
          id_jprod_n_100    = -1, &
          id_jzloss_n_100   = -1, &
          id_jvirloss_n_100 = -1, &
          id_jremin_n_100   = -1, &
          id_juptake_ldon_100 = -1, &
          id_f_n_100
      end type bacteria

! ---------------------------------------------------------------------

      type generic_COBALT_type

     logical  ::       &
          init,             &                  ! If tracers should be initializated
          p_2_n_static,     &                  ! If P:N is fixed in phytoplankton
          tracer_debug

     real(8)  ::          &
          atm_co2_flux,     &
          c_2_n,            &
          ca_2_n_arag,      &
          ca_2_n_calc,      &
          caco3_sat_max,    &
          fe_2_n_upt_fac,   &
          fe_2_n_sed,       &
          fe_coast,         &
          felig_2_don,      &
          felig_bkg ,       &
          gamma_cadet_arag, &
          gamma_cadet_calc, &
          gamma_irr_mem,    &
          gamma_ndet,       &
          gamma_nitrif,     &
          gamma_sidet,      &
          gamma_srdon,      &
          gamma_srdop,      &
          gamma_sldon,      &
          gamma_sldop,      &
          irr_inhibit,      &
          k_n_inhib_di,     &
          k_o2,             &
          kappa_eppley,     &
          kappa_remin,      &
          kfe_eq_lig_hl,    &
          kfe_eq_lig_ll,    &
          alpha_fescav,     &
          beta_fescav,      &
          gamma_fescav,     &
          ki_fescav,        &
          io_fescav,        &
          remin_eff_fedet,  &
          k_lith,           &
          phi_lith,         &
          mass_2_n,         &
          alk_2_n_denit,    &
          n_2_n_denit,      &
          k_no3_denit,      &
          o2_min,           &
          o2_2_c,           &
          o2_2_nfix,        &
          o2_2_nh4,         &
          o2_2_no3,         &
          o2_2_nitrif,      &
          o2_inhib_di_pow,  &
          o2_inhib_di_sat,  &
          P_C_max_assem,    &
          rpcaco3,          &
          rplith,           &
          rpsio2,           &
          thetamin,         &
          thetamin_nolim,   &
          vir_ktemp,        &
          lysis_phi_ldon,   &
          lysis_phi_srdon,  &
          lysis_phi_sldon,  &
          lysis_phi_ldop,   &
          lysis_phi_srdop,  &
          lysis_phi_sldop,  &
          wsink,            &
          z_sed,            &
          zeta,             &
          imax_hp,          & ! unresolved higher pred. max ingestion rate
          ki_hp,            & ! unresolved higher pred. half-sat
          ktemp_hp,         & ! temperature dependence for higher predators
          coef_hp,          & ! scaling between unresolved preds and available prey
          nswitch_hp,       & ! higher predator switching behavior
          mswitch_hp,       & ! higher predator switching behavior
          hp_ipa_smp,       & ! innate prey availability of small phytos to hp's
          hp_ipa_lgp,       & ! "  "  "  "  "  "  "  "  "   large phytos to hp's
          hp_ipa_diaz,      & ! "  "  "  "  "  "  "  "  "   diazotrophs to hp's
          hp_ipa_bact,      & ! "  "  "  "  "  "  "  "  "   bacteria to hp's
          hp_ipa_smz,       & ! "  "  "  "  "  "  "  "  "   small zooplankton to hp's
          hp_ipa_mdz,       & ! "  "  "  "  "  "  "  "  "   medium zooplankton to hp's
          hp_ipa_lgz,       & ! "  "  "  "  "  "  "  "  "   large zooplankton to hp's
          hp_ipa_det,       & ! "  "  "  "  "  "  "  "  "   detritus to hp's
          hp_phi_det,       & ! fraction of ingested N to detritus
          hp_phi_ldon,      & ! fraction of ingested N to labile don
          hp_phi_sldon,     & ! fraction of ingested N to semi-labile don
          hp_phi_srdon,     & ! fraction of ingested N to semi-refractory don
          hp_phi_ldop,      & ! fraction of ingested N to labile dop
          hp_phi_sldop,     & ! fraction of ingested N to semi-labile dop
          hp_phi_srdop,     & ! fraction of ingested N to semi-refractory dop
          hp_phi_nh4,       & ! fraction of ingested N to nh4 due to ingestion-related metabolism
          hp_phi_po4          ! fraction of ingested N to po4 due to ingestion-related metabolism


     real(8), dimension(3)                    :: total_atm_co2

     real(8)    :: htotal_scale_lo, htotal_scale_hi, htotal_in
     real(8)    :: Rho_0, a_0, a_1, a_2, a_3, a_4, a_5, b_0, b_1, b_2, b_3, c_0
     real(8)    :: a1_co2, a2_co2, a3_co2, a4_co2, a1_o2, a2_o2, a3_o2, a4_o2

     real(8), dimension(:,:,:), ALLOCATABLE ::  &
          f_temp, &
          f_salt, &
          f_alk,&                               ! Other prognostic variables
          f_cadet_arag,&
          f_cadet_calc,&
          f_dic,&
          f_fed,&
          f_fedet,&
          f_ldon,&
          f_ldop,&
          f_lith,&
          f_lithdet,&
          f_ndet,&
          f_nh4,&
          f_no3,&
          f_o2,&
          f_pdet,&
          f_po4,&
          f_srdon,&
          f_srdop,&
          f_sldon,&
          f_sldop,&
          f_sidet,&
          f_silg,&
          f_sio4,&
          co3_sol_arag,&
          co3_sol_calc,&
          f_chl,&
          f_co3_ion,&
          f_htotal,&
          f_irr_mem,&
          f_cased,&
          f_cadet_arag_btf,&
          f_cadet_calc_btf,&
          f_fedet_btf, &
          f_lithdet_btf, &
          f_ndet_btf,&
          f_pdet_btf,&
          f_sidet_btf,&
          jnbact,&
          jndi,&
          jnsm,&
          jnlg,&
          jnsmz,&
          jnmdz,&
          jnlgz,&
          jalk,&
          jcadet_arag,&
          jcadet_calc,&
          jdic,&
          jfed,&
          jfedi,&
          jfelg,&
          jfesm,&
          jfedet,&
          jldon,&
          jldop,&
          jlith,&
          jlithdet,&
          jndet,&
          jnh4,&
          jno3,&
          jo2,&
          jpdet,&
          jpo4,&
          jsrdon,&
          jsrdop,&
          jsldon,&
          jsldop,&
          jsidet,&
          jsilg,&
          jsio4,&
          jprod_ndet,&
          jprod_pdet,&
          jprod_ldon,&
          jprod_ldop,&
          jprod_sldon,&
          jprod_sldop,&
          jprod_srdon,&
          jprod_srdop,&
          jprod_fedet,&
          jprod_fed,&
          jprod_sidet,&
          jprod_sio4, &
          jprod_lithdet,&
          jprod_cadet_arag,&
          jprod_cadet_calc,&
          jprod_nh4,&
          jprod_po4,&
          det_jzloss_n,&
          det_jzloss_p,&
          det_jzloss_fe,&
          det_jzloss_si,&
          det_jhploss_n,&
          det_jhploss_p,&
          det_jhploss_fe,&
          det_jhploss_si,&
          jdiss_cadet_arag,&
          jdiss_cadet_calc,&
          jdiss_sidet,&
          jremin_ndet,&
          jremin_pdet,&
          jremin_fedet,&
          jfe_ads,&
          jfe_coast,&
          kfe_eq_lig,&
          expkT,&
          hp_temp_lim,&
          hp_jingest_n,&
          hp_jingest_p,&
          hp_jingest_fe,&
          hp_jingest_sio2,&
          irr_inst,&
          irr_mix,&
          jno3denit_wc,&
          jnitrif,&
          omega_arag,&
          omega_calc,&
          tot_layer_int_c,&
          tot_layer_int_fe,&
          tot_layer_int_n,&
          tot_layer_int_p,&
          tot_layer_int_si,&
          total_filter_feeding,&
          net_prim_prod,&
          gross_prim_prod,&
          nlg_diatoms,&
          q_si_2_n_lg_diatoms,&
          zt, &
          zm

     real(8), dimension(:,:), ALLOCATABLE :: &
          b_alk,b_dic,b_fed,b_nh4,b_no3,b_o2,b_po4,b_sio4,&     ! bottom flux terms
          co2_csurf,pco2_csurf,co2_alpha,&
          fcadet_arag_btm,&
          fcadet_calc_btm,&
          ffedet_btm,&
          flithdet_btm,&
          fpdet_btm,&
          fndet_btm,&
          fsidet_btm,&
          fcased_burial,&
          fcased_input,&
          fcased_redis,&
          ffe_sed,&
          fnfeso4red_sed,&
          fno3denit_sed,&
          fnoxic_sed,&
          frac_burial,&
          fndet_burial,&
          fpdet_burial,&
          jprod_allphytos_100,&
          htotallo, htotalhi,&
          hp_jingest_n_100,&
          hp_jremin_n_100,&
          hp_jprod_ndet_100,&
          jprod_lithdet_100,&
          jprod_sidet_100,&
          jprod_cadet_calc_100,&
          jprod_cadet_arag_100,&
          jprod_mesozoo_200, &
          jremin_ndet_100, &
          f_ndet_100, &
          f_don_100, &
          f_silg_100, &
          f_mesozoo_200, &
          fndet_100, &
          fpdet_100, &
          fsidet_100, &
          fcadet_calc_100, &
          fcadet_arag_100, &
          ffedet_100, &
          flithdet_100, &
          btm_temp,     &
          btm_o2

     real(8), dimension(:,:,:,:), pointer :: &
          p_alk,&
          p_cadet_arag,&
          p_cadet_calc,&
          p_dic,&
          p_fed,&
          p_fedi,&
          p_felg,&
          p_fedet,&
          p_fesm,&
          p_ldon,&
          p_ldop,&
          p_lith,&
          p_lithdet,&
          p_nbact,&
          p_ndet,&
          p_ndi,&
          p_nlg,&
          p_nsm,&
          p_nh4,&
          p_no3,&
          p_o2,&
          p_pdet,&
          p_po4,&
          p_srdon,&
          p_srdop,&
          p_sldon,&
          p_sldop,&
          p_sidet,&
          p_silg,&
          p_sio4,&
          p_nsmz,&
          p_nmdz,&
          p_nlgz

      real(8), dimension (:,:), pointer :: &
          runoff_flux_alk,&
          runoff_flux_dic,&
          runoff_flux_lith,&
          runoff_flux_fed,&
          runoff_flux_no3,&
          runoff_flux_ldon,&
          runoff_flux_sldon,&
          runoff_flux_srdon,&
          runoff_flux_ndet,&
          runoff_flux_po4,&
          runoff_flux_ldop,&
          runoff_flux_sldop,&
          runoff_flux_srdop,&
          dry_fed, wet_fed,&
          dry_lith, wet_lith,&
          dry_no3, wet_no3,&
          dry_nh4, wet_nh4,&
          dry_po4, wet_po4

      integer :: nkml
!      character(len=fm_string_len)          :: file
!      character(len=fm_string_len) :: ice_restart_file
!      character(len=fm_string_len) :: ocean_restart_file,IC_file

      integer               ::          &
          id_ndi           = -1,       &
          id_nlg           = -1,       &
          id_nsm           = -1,       &
          id_nsmz          = -1,       &
          id_nmdz          = -1,       &
          id_nlgz          = -1,       &
          id_nbact         = -1,       &
          id_alk           = -1,       &
          id_cadet_arag    = -1,       &
          id_cadet_calc    = -1,       &
          id_dic           = -1,       &
          id_fed           = -1,       &
          id_fedi          = -1,       &
          id_felg          = -1,       &
          id_fesm          = -1,       &
          id_fedet         = -1,       &
          id_ldon          = -1,       &
          id_ldop          = -1,       &
          id_lith          = -1,       &
          id_lithdet       = -1,       &
          id_ndet          = -1,       &
          id_nh4           = -1,       &
          id_no3           = -1,       &
          id_o2            = -1,       &
          id_pdet          = -1,       &
          id_po4           = -1,       &
          id_srdop         = -1,       &
          id_srdon         = -1,       &
          id_sldon         = -1,       &
          id_sldop         = -1,       &
          id_sidet         = -1,       &
          id_silg          = -1,       &
          id_sio4          = -1,       &
          id_co3_sol_arag  = -1,       &
          id_co3_sol_calc  = -1,       &
          id_dep_dry_fed   = -1,       &
          id_dep_dry_nh4   = -1,       &
          id_dep_dry_no3   = -1,       &
          id_dep_dry_po4   = -1,       &
          id_dep_wet_fed   = -1,       &
          id_dep_wet_nh4   = -1,       &
          id_dep_wet_no3   = -1,       &
          id_dep_wet_po4   = -1,       &
          id_dep_wet_lith  = -1,       &
          id_dep_dry_lith  = -1,       &
          id_omega_arag    = -1,       &
          id_omega_calc    = -1,       &
          id_chl           = -1,       &
          id_co3_ion       = -1,       &
          id_htotal        = -1,       &
          id_irr_mem       = -1,       &
          id_cased         = -1,       &
          id_cadet_arag_btf = -1,      &
          id_cadet_calc_btf = -1,      &
          id_fedet_btf     = -1,       &
          id_lithdet_btf   = -1,       &
          id_ndet_btf      = -1,       &
          id_pdet_btf      = -1,       &
          id_sidet_btf     = -1,       &
          id_jprod_ndet    = -1,       &
          id_jprod_pdet    = -1,       &
          id_jprod_sldon   = -1,       &
          id_jprod_ldon    = -1,       &
          id_jprod_srdon   = -1,       &
          id_jprod_sldop   = -1,       &
          id_jprod_ldop    = -1,       &
          id_jprod_srdop   = -1,       &
          id_jprod_fedet   = -1,       &
          id_jprod_fed     = -1,       &
          id_jprod_sidet   = -1,       &
          id_jprod_sio4    = -1,       &
          id_jprod_lithdet = -1,       &
          id_jprod_cadet_arag = -1,    &
          id_jprod_cadet_calc = -1,    &
          id_jprod_po4     = -1,       &
          id_jprod_nh4     = -1,       &
          id_det_jzloss_n  = -1,       &
          id_det_jzloss_p  = -1,       &
          id_det_jzloss_fe = -1,       &
          id_det_jzloss_si = -1,       &
          id_det_jhploss_n = -1,       &
          id_det_jhploss_p = -1,       &
          id_det_jhploss_fe = -1,      &
          id_det_jhploss_si = -1,      &
          id_jdiss_sidet   = -1,       &
          id_jdiss_cadet_arag = -1,    &
          id_jdiss_cadet_calc = -1,    &
          id_jremin_ndet   = -1,       &
          id_jremin_pdet   = -1,       &
          id_jremin_fedet  = -1,       &
          id_jfe_ads       = -1,       &
          id_jfe_coast     = -1,       &
          id_kfe_eq_lig    = -1,       &
          id_expkT         = -1,       &
          id_hp_temp_lim   = -1,       &
          id_hp_jingest_n  = -1,       &
          id_hp_jingest_p  = -1,       &
          id_hp_jingest_fe = -1,       &
          id_hp_jingest_sio2 = -1,     &
          id_irr_inst      = -1,       &
          id_irr_mix       = -1,       &
          id_jno3denit_wc  = -1,       &
          id_jnitrif       = -1,       &
          id_co2_csurf     = -1,       &
          id_pco2_csurf    = -1,       &
          id_co2_alpha     = -1,       &
          id_fcadet_arag   = -1,       &
          id_fcadet_calc   = -1,       &
          id_ffedet        = -1,       &
          id_fndet         = -1,       &
          id_fpdet         = -1,       &
          id_fsidet        = -1,       &
          id_flithdet      = -1,       &
          id_fcadet_arag_btm = -1,     &
          id_fcadet_calc_btm = -1,     &
          id_ffedet_btm    = -1,       &
          id_flithdet_btm  = -1,       &
          id_fndet_btm     = -1,       &
          id_fpdet_btm     = -1,       &
          id_fsidet_btm    = -1,       &
          id_fcased_burial = -1,       &
          id_fcased_input  = -1,       &
          id_fcased_redis  = -1,       &
          id_ffe_sed       = -1,       &
          id_fnfeso4red_sed= -1,       &
          id_fno3denit_sed = -1,       &
          id_fnoxic_sed    = -1,       &
          id_frac_burial   = -1,       &
          id_fndet_burial  = -1,       &
          id_fpdet_burial  = -1,       &
          id_nphyto_tot    = -1,       &
          id_no3_in_source = -1,       &
          id_pco2surf      = -1,       &
          id_sfc_alk       = -1,       &
          id_sfc_cadet_arag= -1,       &
          id_sfc_cadet_calc= -1,       &
          id_sfc_dic       = -1,       &
          id_sfc_fed       = -1,       &
          id_sfc_ldon      = -1,       &
          id_sfc_sldon     = -1,       &
          id_sfc_srdon     = -1,       &
          id_sfc_no3       = -1,       &
          id_sfc_nh4       = -1,       &
          id_sfc_po4       = -1,       &
          id_sfc_sio4      = -1,       &
          id_sfc_htotal    = -1,       &
          id_sfc_o2        = -1,       &
          id_sfc_chl       = -1,       &
          id_sfc_irr       = -1,       &
          id_sfc_irr_mem   = -1,       &
          id_sfc_temp      = -1,       &
          id_btm_temp      = -1,       &
          id_btm_o2        = -1,       &
          id_sfc_co3_ion   = -1,       &
          id_sfc_co3_sol_arag = -1,    &
          id_sfc_co3_sol_calc = -1,    &
          id_runoff_flux_alk = -1,     &
          id_runoff_flux_dic = -1,     &
          id_runoff_flux_fed = -1,     &
          id_runoff_flux_lith = -1,    &
          id_runoff_flux_no3 = -1,     &
          id_runoff_flux_ldon = -1,    &
          id_runoff_flux_sldon = -1,   &
          id_runoff_flux_srdon = -1,   &
          id_runoff_flux_ndet = -1,    &
          id_runoff_flux_po4 = -1,     &
          id_runoff_flux_ldop = -1,    &
          id_runoff_flux_sldop = -1,   &
          id_runoff_flux_srdop = -1,   &
          id_tot_layer_int_c = -1,     &
          id_tot_layer_int_fe = -1,    &
          id_tot_layer_int_n = -1,     &
          id_tot_layer_int_p = -1,     &
          id_tot_layer_int_si = -1,    &
          id_total_filter_feeding = -1,&
          id_net_prim_prod = -1,       &
          id_gross_prim_prod = -1,     &
          id_nlg_diatoms = -1,         &
          id_jprod_allphytos_100 = -1, &
          id_q_si_2_n_lg_diatoms = -1, &
          id_hp_jingest_n_100 = -1,    &
          id_hp_jremin_n_100 = -1,     &
          id_hp_jprod_ndet_100 = -1,   &
          id_jprod_lithdet_100 = -1,   &
          id_jprod_sidet_100 = -1,     &
          id_jprod_cadet_calc_100 = -1, &
          id_jprod_cadet_arag_100 = -1, &
          id_jprod_mesozoo_200 = -1,   &
          id_jremin_ndet_100 = -1,     &
          id_f_ndet_100 = -1,          &
          id_f_don_100 = -1,           &
          id_f_silg_100 = -1,          &
          id_f_mesozoo_200 = -1,       &
          id_fndet_100 = -1,           &
          id_fpdet_100 = -1,           &
          id_ffedet_100 = -1,          &
          id_fcadet_calc_100 = -1,     &
          id_fcadet_arag_100 = -1,     &
          id_flithdet_100 = -1,        &
          id_fsidet_100
      end type generic_COBALT_type

! ---------------------------------------------------------------------
! End declaration types ------------------------------------------

      integer, parameter :: NUM_PHYTO  = 3
!
! Array allocations and flux calculations assume that phyto(1) is the
! only phytoplankton group cabable of nitrogen uptake by N2 fixation while phyto(2:NUM_PHYTO)
! are only cabable of nitrgen uptake by NH4 and NO3 uptake
!
      integer, parameter :: DIAZO      = 1
      integer, parameter :: LARGE      = 2
      integer, parameter :: SMALL      = 3
      type(phytoplankton), save, dimension(NUM_PHYTO) :: phyto

! define three zooplankton types
      integer, parameter :: NUM_ZOO = 3
      type(zooplankton), save, dimension(NUM_ZOO) :: zoo

      type(bacteria), save, dimension(1) :: bact

      integer, parameter :: NUM_PREY = 8
      type(generic_COBALT_type), save :: cobalt



      CONTAINS

      SUBROUTINE initialize_biology
!
!=======================================================================
!                                                                      !
!  This routine sets several variables needed by the biology model.    !
!  It allocates and assigns biological tracers indices.                !
!                                                                      !
!=======================================================================
!
!  Local variable declarations
!
      integer :: i, ic
!
!-----------------------------------------------------------------------
!  Determine number of biological tracers.
!-----------------------------------------------------------------------
!

      ! Nitrogen Dynamics
      NBT=13
#ifdef COBALT_MINERALS
      ! Biogenic Minerals and Lithogenic Materials
      NBT=NBT+7
#endif
#ifdef COBALT_PHOSPHORUS
      ! Phosporus Dynamics
      NBT=NBT+5
#endif
#ifdef COBALT_IRON
      ! Iron Dynamics
      NBT=NBT+5
#endif
#ifdef COBALT_CARBON
      ! Oxygen, Carbon and Alkalinity
      NBT=NBT+3
#endif


      ! Diagnostic tracers
      NDbio2d = 24
      NDbio3d = 37

#ifdef BENTHIC
      NBEN=6
#endif

      Nsink=7

!-----------------------------------------------------------------------
!  Allocate various module variables.
!-----------------------------------------------------------------------

! Parameters read in namelist


      IF (.not.allocated(BioIter)) THEN
        allocate ( BioIter(Ngrids) )
      END IF
      IF (.not.allocated(htotal_scale_lo)) THEN
        allocate ( htotal_scale_lo(Ngrids) )
      END IF
      IF (.not.allocated(htotal_scale_hi)) THEN
        allocate ( htotal_scale_hi(Ngrids) )
      END IF
      IF (.not.allocated(RHO_0)) THEN
        allocate ( RHO_0(Ngrids) )
      END IF
      IF (.not.allocated(NKML)) THEN
        allocate ( NKML(Ngrids) )
      END IF
      IF (.not.allocated(a_0)) THEN
        allocate ( a_0(Ngrids) )
      END IF
      IF (.not.allocated(a_1)) THEN
        allocate ( a_1(Ngrids) )
      END IF
      IF (.not.allocated(a_2)) THEN
        allocate ( a_2(Ngrids) )
      END IF
      IF (.not.allocated(a_3)) THEN
        allocate ( a_3(Ngrids) )
      END IF
      IF (.not.allocated(a_4)) THEN
        allocate ( a_4(Ngrids) )
      END IF
      IF (.not.allocated(a_5)) THEN
        allocate ( a_5(Ngrids) )
      END IF
      IF (.not.allocated(b_0)) THEN
        allocate ( b_0(Ngrids) )
      END IF
      IF (.not.allocated(b_1)) THEN
        allocate ( b_1(Ngrids) )
      END IF
      IF (.not.allocated(b_2)) THEN
        allocate ( b_2(Ngrids) )
      END IF
      IF (.not.allocated(b_3)) THEN
        allocate ( b_3(Ngrids) )
      END IF
      IF (.not.allocated(c_0)) THEN
        allocate ( c_0(Ngrids) )
      END IF
      IF (.not.allocated(a1_co2)) THEN
        allocate ( a1_co2(Ngrids) )
      END IF
      IF (.not.allocated(a2_co2)) THEN
        allocate ( a2_co2(Ngrids) )
      END IF
      IF (.not.allocated(a3_co2)) THEN
        allocate ( a3_co2(Ngrids) )
      END IF
      IF (.not.allocated(a4_co2)) THEN
        allocate ( a4_co2(Ngrids) )
      END IF
      IF (.not.allocated(a1_o2)) THEN
        allocate ( a1_o2(Ngrids) )
      END IF
      IF (.not.allocated(a2_o2)) THEN
        allocate ( a2_o2(Ngrids) )
      END IF
      IF (.not.allocated(a3_o2)) THEN
        allocate ( a3_o2(Ngrids) )
      END IF
      IF (.not.allocated(a4_o2)) THEN
        allocate ( a4_o2(Ngrids) )
      END IF
      IF (.not.allocated(mass_2_n)) THEN
        allocate ( mass_2_n(Ngrids) )
      END IF
      IF (.not.allocated(n_2_n_denit)) THEN
        allocate ( n_2_n_denit(Ngrids) )
      END IF
      IF (.not.allocated(o2_2_c)) THEN
        allocate ( o2_2_c(Ngrids) )
      END IF
      IF (.not.allocated(o2_2_nfix)) THEN
        allocate ( o2_2_nfix(Ngrids) )
      END IF
      IF (.not.allocated(o2_2_nh4)) THEN
        allocate ( o2_2_nh4(Ngrids) )
      END IF
      IF (.not.allocated(o2_2_nitrif)) THEN
        allocate ( o2_2_nitrif(Ngrids) )
      END IF
      IF (.not.allocated(o2_2_no3)) THEN
        allocate ( o2_2_no3(Ngrids) )
      END IF
      IF (.not.allocated(k_fed_Di)) THEN
        allocate ( k_fed_Di(Ngrids) )
      END IF
      IF (.not.allocated(k_fed_Lg)) THEN
        allocate ( k_fed_Lg(Ngrids) )
      END IF
      IF (.not.allocated(k_fed_Sm)) THEN
        allocate ( k_fed_Sm(Ngrids) )
      END IF
      IF (.not.allocated(k_nh4_Lg)) THEN
        allocate ( k_nh4_Lg(Ngrids) )
      END IF
      IF (.not.allocated(k_nh4_Sm)) THEN
        allocate ( k_nh4_Sm(Ngrids) )
      END IF
      IF (.not.allocated(k_nh4_Di)) THEN
        allocate ( k_nh4_Di(Ngrids) )
      END IF
      IF (.not.allocated(k_no3_Lg)) THEN
        allocate ( k_no3_Lg(Ngrids) )
      END IF
      IF (.not.allocated(k_no3_Sm)) THEN
        allocate ( k_no3_Sm(Ngrids) )
      END IF
      IF (.not.allocated(k_no3_Di)) THEN
        allocate ( k_no3_Di(Ngrids) )
      END IF
      IF (.not.allocated(k_po4_Di)) THEN
        allocate ( k_po4_Di(Ngrids) )
      END IF
      IF (.not.allocated(k_po4_Lg)) THEN
        allocate ( k_po4_Lg(Ngrids) )
      END IF
      IF (.not.allocated(k_po4_Sm)) THEN
        allocate ( k_po4_Sm(Ngrids) )
      END IF
      IF (.not.allocated(k_sio4_Lg)) THEN
        allocate ( k_sio4_Lg(Ngrids) )
      END IF
      IF (.not.allocated(k_fe_2_n_Di)) THEN
        allocate ( k_fe_2_n_Di(Ngrids) )
      END IF
      IF (.not.allocated(k_fe_2_n_Lg)) THEN
        allocate ( k_fe_2_n_Lg(Ngrids) )
      END IF
      IF (.not.allocated(k_fe_2_n_Sm)) THEN
        allocate ( k_fe_2_n_Sm(Ngrids) )
      END IF
      IF (.not.allocated(fe_2_n_max_Sm)) THEN
        allocate ( fe_2_n_max_Sm(Ngrids) )
      END IF
      IF (.not.allocated(fe_2_n_max_Lg)) THEN
        allocate ( fe_2_n_max_Lg(Ngrids) )
      END IF
      IF (.not.allocated(fe_2_n_max_Di)) THEN
        allocate ( fe_2_n_max_Di(Ngrids) )
      END IF
      IF (.not.allocated(fe_2_n_upt_fac)) THEN
        allocate ( fe_2_n_upt_fac(Ngrids) )
      END IF
      IF (.not.allocated(alpha_Di)) THEN
        allocate ( alpha_Di(Ngrids) )
      END IF
      IF (.not.allocated(alpha_Lg)) THEN
        allocate ( alpha_Lg(Ngrids) )
      END IF
      IF (.not.allocated(alpha_Sm)) THEN
        allocate ( alpha_Sm(Ngrids) )
      END IF
      IF (.not.allocated(kappa_eppley)) THEN
        allocate ( kappa_eppley(Ngrids) )
      END IF
      IF (.not.allocated(P_C_max_Di)) THEN
        allocate ( P_C_max_Di(Ngrids) )
      END IF
      IF (.not.allocated(P_C_max_Lg)) THEN
        allocate ( P_C_max_Lg(Ngrids) )
      END IF
      IF (.not.allocated(P_C_max_Sm)) THEN
        allocate ( P_C_max_Sm(Ngrids) )
      END IF
      IF (.not.allocated(thetamax_Di)) THEN
        allocate ( thetamax_Di(Ngrids) )
      END IF
      IF (.not.allocated(thetamax_Lg)) THEN
        allocate ( thetamax_Lg(Ngrids) )
      END IF
      IF (.not.allocated(thetamax_Sm)) THEN
        allocate ( thetamax_Sm(Ngrids) )
      END IF
      IF (.not.allocated(bresp_Di)) THEN
        allocate ( bresp_Di(Ngrids) )
      END IF
      IF (.not.allocated(bresp_Lg)) THEN
        allocate ( bresp_Lg(Ngrids) )
      END IF
      IF (.not.allocated(bresp_Sm)) THEN
        allocate ( bresp_Sm(Ngrids) )
      END IF
      IF (.not.allocated(thetamin)) THEN
        allocate ( thetamin(Ngrids) )
      END IF
      IF (.not.allocated(thetamin_nolim)) THEN
        allocate ( thetamin_nolim(Ngrids) )
      END IF
      IF (.not.allocated(zpllgr)) THEN
        allocate ( zpllgr(Ngrids) )
      END IF
      IF (.not.allocated(gamma_irr_mem)) THEN
        allocate ( gamma_irr_mem(Ngrids) )
      END IF
      IF (.not.allocated(k_n_inhib_Di)) THEN
        allocate ( k_n_inhib_Di(Ngrids) )
      END IF
      IF (.not.allocated(o2_inhib_Di_pow)) THEN
        allocate ( o2_inhib_Di_pow(Ngrids) )
      END IF
      IF (.not.allocated(o2_inhib_Di_sat)) THEN
        allocate ( o2_inhib_Di_sat(Ngrids) )
      END IF
      IF (.not.allocated(p_2_n_static)) THEN
        allocate ( p_2_n_static(Ngrids) )
      END IF
      IF (.not.allocated(c_2_n)) THEN
        allocate ( c_2_n(Ngrids) )
      END IF
      IF (.not.allocated(alk_2_n_denit)) THEN
        allocate ( alk_2_n_denit(Ngrids) )
      END IF
      IF (.not.allocated(p_2_n_static_Di)) THEN
        allocate ( p_2_n_static_Di(Ngrids) )
      END IF
      IF (.not.allocated(p_2_n_static_Lg)) THEN
        allocate ( p_2_n_static_Lg(Ngrids) )
      END IF
      IF (.not.allocated(p_2_n_static_Sm)) THEN
        allocate ( p_2_n_static_Sm(Ngrids) )
      END IF
      IF (.not.allocated(si_2_n_static_Lg)) THEN
        allocate ( si_2_n_static_Lg(Ngrids) )
      END IF
      IF (.not.allocated(si_2_n_max_Lg)) THEN
        allocate ( si_2_n_max_Lg(Ngrids) )
      END IF
      IF (.not.allocated(ca_2_n_arag)) THEN
        allocate ( ca_2_n_arag(Ngrids) )
      END IF
      IF (.not.allocated(ca_2_n_calc)) THEN
        allocate ( ca_2_n_calc(Ngrids) )
      END IF
      IF (.not.allocated(caco3_sat_max)) THEN
        allocate ( caco3_sat_max(Ngrids) )
      END IF
      IF (.not.allocated(q_p_2_n_smz)) THEN
        allocate ( q_p_2_n_smz(Ngrids) )
      END IF
      IF (.not.allocated(q_p_2_n_mdz)) THEN
        allocate ( q_p_2_n_mdz(Ngrids) )
      END IF
      IF (.not.allocated(q_p_2_n_lgz)) THEN
        allocate ( q_p_2_n_lgz(Ngrids) )
      END IF
      IF (.not.allocated(q_p_2_n_bact)) THEN
        allocate ( q_p_2_n_bact(Ngrids) )
      END IF
      IF (.not.allocated(agg_Sm)) THEN
        allocate ( agg_Sm(Ngrids) )
      END IF
      IF (.not.allocated(agg_Di)) THEN
        allocate ( agg_Di(Ngrids) )
      END IF
      IF (.not.allocated(agg_Lg)) THEN
        allocate ( agg_Lg(Ngrids) )
      END IF
      IF (.not.allocated(vir_Sm)) THEN
        allocate ( vir_Sm(Ngrids) )
      END IF
      IF (.not.allocated(vir_Di)) THEN
        allocate ( vir_Di(Ngrids) )
      END IF
      IF (.not.allocated(vir_Lg)) THEN
        allocate ( vir_Lg(Ngrids) )
      END IF
      IF (.not.allocated(vir_Bact)) THEN
        allocate ( vir_Bact(Ngrids) )
      END IF
      IF (.not.allocated(ktemp_vir)) THEN
        allocate ( ktemp_vir(Ngrids) )
      END IF
      IF (.not.allocated(exu_Sm)) THEN
        allocate ( exu_Sm(Ngrids) )
      END IF
      IF (.not.allocated(exu_Di)) THEN
        allocate ( exu_Di(Ngrids) )
      END IF
      IF (.not.allocated(exu_Lg)) THEN
        allocate ( exu_Lg(Ngrids) )
      END IF
      IF (.not.allocated(imax_smz)) THEN
        allocate ( imax_smz(Ngrids) )
      END IF
      IF (.not.allocated(imax_mdz)) THEN
        allocate ( imax_mdz(Ngrids) )
      END IF
      IF (.not.allocated(imax_lgz)) THEN
        allocate ( imax_lgz(Ngrids) )
      END IF
      IF (.not.allocated(ki_smz)) THEN
        allocate ( ki_smz(Ngrids) )
      END IF
      IF (.not.allocated(ki_mdz)) THEN
        allocate ( ki_mdz(Ngrids) )
      END IF
      IF (.not.allocated(ki_lgz)) THEN
        allocate ( ki_lgz(Ngrids) )
      END IF
      IF (.not.allocated(ktemp_smz)) THEN
        allocate ( ktemp_smz(Ngrids) )
      END IF
      IF (.not.allocated(ktemp_mdz)) THEN
        allocate ( ktemp_mdz(Ngrids) )
      END IF
      IF (.not.allocated(ktemp_lgz)) THEN
        allocate ( ktemp_lgz(Ngrids) )
      END IF
      IF (.not.allocated(mu_max_bact)) THEN
        allocate ( mu_max_bact(Ngrids) )
      END IF
      IF (.not.allocated(k_ldon_bact)) THEN
        allocate ( k_ldon_bact(Ngrids) )
      END IF
      IF (.not.allocated(ktemp_bact)) THEN
        allocate ( ktemp_bact(Ngrids) )
      END IF
      IF (.not.allocated(nswitch_smz)) THEN
        allocate ( nswitch_smz(Ngrids) )
      END IF
      IF (.not.allocated(nswitch_mdz)) THEN
        allocate ( nswitch_mdz(Ngrids) )
      END IF
      IF (.not.allocated(nswitch_lgz)) THEN
        allocate ( nswitch_lgz(Ngrids) )
      END IF
      IF (.not.allocated(mswitch_smz)) THEN
        allocate ( mswitch_smz(Ngrids) )
      END IF
      IF (.not.allocated(mswitch_mdz)) THEN
        allocate ( mswitch_mdz(Ngrids) )
      END IF
      IF (.not.allocated(mswitch_lgz)) THEN
        allocate ( mswitch_lgz(Ngrids) )
      END IF
      IF (.not.allocated(smz_ipa_smp)) THEN
        allocate ( smz_ipa_smp(Ngrids) )
      END IF
      IF (.not.allocated(smz_ipa_lgp)) THEN
        allocate ( smz_ipa_lgp(Ngrids) )
      END IF
      IF (.not.allocated(smz_ipa_diaz)) THEN
        allocate ( smz_ipa_diaz(Ngrids) )
      END IF
      IF (.not.allocated(smz_ipa_smz)) THEN
        allocate ( smz_ipa_smz(Ngrids) )
      END IF
      IF (.not.allocated(smz_ipa_mdz)) THEN
        allocate ( smz_ipa_mdz(Ngrids) )
      END IF
      IF (.not.allocated(smz_ipa_lgz)) THEN
        allocate ( smz_ipa_lgz(Ngrids) )
      END IF
      IF (.not.allocated(smz_ipa_bact)) THEN
        allocate ( smz_ipa_bact(Ngrids) )
      END IF
      IF (.not.allocated(smz_ipa_det)) THEN
        allocate ( smz_ipa_det(Ngrids) )
      END IF
      IF (.not.allocated(mdz_ipa_smp)) THEN
        allocate ( mdz_ipa_smp(Ngrids) )
      END IF
      IF (.not.allocated(mdz_ipa_lgp)) THEN
        allocate ( mdz_ipa_lgp(Ngrids) )
      END IF
      IF (.not.allocated(mdz_ipa_diaz)) THEN
        allocate ( mdz_ipa_diaz(Ngrids) )
      END IF
      IF (.not.allocated(mdz_ipa_smz)) THEN
        allocate ( mdz_ipa_smz(Ngrids) )
      END IF
      IF (.not.allocated(mdz_ipa_mdz)) THEN
        allocate ( mdz_ipa_mdz(Ngrids) )
      END IF
      IF (.not.allocated(mdz_ipa_lgz)) THEN
        allocate ( mdz_ipa_lgz(Ngrids) )
      END IF
      IF (.not.allocated(mdz_ipa_bact)) THEN
        allocate ( mdz_ipa_bact(Ngrids) )
      END IF
      IF (.not.allocated(mdz_ipa_det)) THEN
        allocate ( mdz_ipa_det(Ngrids) )
      END IF
      IF (.not.allocated(lgz_ipa_smp)) THEN
        allocate ( lgz_ipa_smp(Ngrids) )
      END IF
      IF (.not.allocated(lgz_ipa_lgp)) THEN
        allocate ( lgz_ipa_lgp(Ngrids) )
      END IF
      IF (.not.allocated(lgz_ipa_diaz)) THEN
        allocate ( lgz_ipa_diaz(Ngrids) )
      END IF
      IF (.not.allocated(lgz_ipa_smz)) THEN
        allocate ( lgz_ipa_smz(Ngrids) )
      END IF
      IF (.not.allocated(lgz_ipa_mdz)) THEN
        allocate ( lgz_ipa_mdz(Ngrids) )
      END IF
      IF (.not.allocated(lgz_ipa_lgz)) THEN
        allocate ( lgz_ipa_lgz(Ngrids) )
      END IF
      IF (.not.allocated(lgz_ipa_bact)) THEN
        allocate ( lgz_ipa_bact(Ngrids) )
      END IF
      IF (.not.allocated(lgz_ipa_det)) THEN
        allocate ( lgz_ipa_det(Ngrids) )
      END IF
      IF (.not.allocated(gge_max_smz)) THEN
        allocate ( gge_max_smz(Ngrids) )
      END IF
      IF (.not.allocated(gge_max_mdz)) THEN
        allocate ( gge_max_mdz(Ngrids) )
      END IF
      IF (.not.allocated(gge_max_lgz)) THEN
        allocate ( gge_max_lgz(Ngrids) )
      END IF
      IF (.not.allocated(bresp_smz)) THEN
        allocate ( bresp_smz(Ngrids) )
      END IF
      IF (.not.allocated(bresp_mdz)) THEN
        allocate ( bresp_mdz(Ngrids) )
      END IF
      IF (.not.allocated(bresp_lgz)) THEN
        allocate ( bresp_lgz(Ngrids) )
      END IF
      IF (.not.allocated(gge_max_bact)) THEN
        allocate ( gge_max_bact(Ngrids) )
      END IF
      IF (.not.allocated(bresp_bact)) THEN
        allocate ( bresp_bact(Ngrids) )
      END IF
      IF (.not.allocated(phi_det_smz)) THEN
        allocate ( phi_det_smz(Ngrids) )
      END IF
      IF (.not.allocated(phi_det_mdz)) THEN
        allocate ( phi_det_mdz(Ngrids) )
      END IF
      IF (.not.allocated(phi_det_lgz)) THEN
        allocate ( phi_det_lgz(Ngrids) )
      END IF
      IF (.not.allocated(phi_ldon_smz)) THEN
        allocate ( phi_ldon_smz(Ngrids) )
      END IF
      IF (.not.allocated(phi_ldon_mdz)) THEN
        allocate ( phi_ldon_mdz(Ngrids) )
      END IF
      IF (.not.allocated(phi_ldon_lgz)) THEN
        allocate ( phi_ldon_lgz(Ngrids) )
      END IF
      IF (.not.allocated(phi_ldop_smz)) THEN
        allocate ( phi_ldop_smz(Ngrids) )
      END IF
      IF (.not.allocated(phi_ldop_mdz)) THEN
        allocate ( phi_ldop_mdz(Ngrids) )
      END IF
      IF (.not.allocated(phi_ldop_lgz)) THEN
        allocate ( phi_ldop_lgz(Ngrids) )
      END IF
      IF (.not.allocated(phi_srdon_smz)) THEN
        allocate ( phi_srdon_smz(Ngrids) )
      END IF
      IF (.not.allocated(phi_srdon_mdz)) THEN
        allocate ( phi_srdon_mdz(Ngrids) )
      END IF
      IF (.not.allocated(phi_srdon_lgz)) THEN
        allocate ( phi_srdon_lgz(Ngrids) )
      END IF
      IF (.not.allocated(phi_srdop_smz)) THEN
        allocate ( phi_srdop_smz(Ngrids) )
      END IF
      IF (.not.allocated(phi_srdop_mdz)) THEN
        allocate ( phi_srdop_mdz(Ngrids) )
      END IF
      IF (.not.allocated(phi_srdop_lgz)) THEN
        allocate ( phi_srdop_lgz(Ngrids) )
      END IF
      IF (.not.allocated(phi_sldon_smz)) THEN
        allocate ( phi_sldon_smz(Ngrids) )
      END IF
      IF (.not.allocated(phi_sldon_mdz)) THEN
        allocate ( phi_sldon_mdz(Ngrids) )
      END IF
      IF (.not.allocated(phi_sldon_lgz)) THEN
        allocate ( phi_sldon_lgz(Ngrids) )
      END IF
      IF (.not.allocated(phi_sldop_smz)) THEN
        allocate ( phi_sldop_smz(Ngrids) )
      END IF
      IF (.not.allocated(phi_sldop_mdz)) THEN
        allocate ( phi_sldop_mdz(Ngrids) )
      END IF
      IF (.not.allocated(phi_sldop_lgz)) THEN
        allocate ( phi_sldop_lgz(Ngrids) )
      END IF
      IF (.not.allocated(phi_nh4_smz)) THEN
        allocate ( phi_nh4_smz(Ngrids) )
      END IF
      IF (.not.allocated(phi_nh4_mdz)) THEN
        allocate ( phi_nh4_mdz(Ngrids) )
      END IF
      IF (.not.allocated(phi_nh4_lgz)) THEN
        allocate ( phi_nh4_lgz(Ngrids) )
      END IF
      IF (.not.allocated(phi_po4_smz)) THEN
        allocate ( phi_po4_smz(Ngrids) )
      END IF
      IF (.not.allocated(phi_po4_mdz)) THEN
        allocate ( phi_po4_mdz(Ngrids) )
      END IF
      IF (.not.allocated(phi_po4_lgz)) THEN
        allocate ( phi_po4_lgz(Ngrids) )
      END IF
      IF (.not.allocated(phi_ldon_vir)) THEN
        allocate ( phi_ldon_vir(Ngrids) )
      END IF
      IF (.not.allocated(phi_srdon_vir)) THEN
        allocate ( phi_srdon_vir(Ngrids) )
      END IF
      IF (.not.allocated(phi_sldon_vir)) THEN
        allocate ( phi_sldon_vir(Ngrids) )
      END IF
      IF (.not.allocated(phi_ldop_vir)) THEN
        allocate ( phi_ldop_vir(Ngrids) )
      END IF
      IF (.not.allocated(phi_srdop_vir)) THEN
        allocate ( phi_srdop_vir(Ngrids) )
      END IF
      IF (.not.allocated(phi_sldop_vir)) THEN
        allocate ( phi_sldop_vir(Ngrids) )
      END IF
      IF (.not.allocated(imax_hp)) THEN
        allocate ( imax_hp(Ngrids) )
      END IF
      IF (.not.allocated(ki_hp)) THEN
        allocate ( ki_hp(Ngrids) )
      END IF
      IF (.not.allocated(coef_hp)) THEN
        allocate ( coef_hp(Ngrids) )
      END IF
      IF (.not.allocated(ktemp_hp)) THEN
        allocate ( ktemp_hp(Ngrids) )
      END IF
      IF (.not.allocated(nswitch_hp)) THEN
        allocate ( nswitch_hp(Ngrids) )
      END IF
      IF (.not.allocated(mswitch_hp)) THEN
        allocate ( mswitch_hp(Ngrids) )
      END IF
      IF (.not.allocated(hp_ipa_smp)) THEN
        allocate ( hp_ipa_smp(Ngrids) )
      END IF
      IF (.not.allocated(hp_ipa_lgp)) THEN
        allocate ( hp_ipa_lgp(Ngrids) )
      END IF
      IF (.not.allocated(hp_ipa_diaz)) THEN
        allocate ( hp_ipa_diaz(Ngrids) )
      END IF
      IF (.not.allocated(hp_ipa_smz)) THEN
        allocate ( hp_ipa_smz(Ngrids) )
      END IF
      IF (.not.allocated(hp_ipa_mdz)) THEN
        allocate ( hp_ipa_mdz(Ngrids) )
      END IF
      IF (.not.allocated(hp_ipa_lgz)) THEN
        allocate ( hp_ipa_lgz(Ngrids) )
      END IF
      IF (.not.allocated(hp_ipa_bact)) THEN
        allocate ( hp_ipa_bact(Ngrids) )
      END IF
      IF (.not.allocated(hp_ipa_det)) THEN
        allocate ( hp_ipa_det(Ngrids) )
      END IF
      IF (.not.allocated(hp_phi_det)) THEN
        allocate ( hp_phi_det(Ngrids) )
      END IF
      IF (.not.allocated(hp_phi_ldon)) THEN
        allocate ( hp_phi_ldon(Ngrids) )
      END IF
      IF (.not.allocated(hp_phi_ldop)) THEN
        allocate ( hp_phi_ldop(Ngrids) )
      END IF
      IF (.not.allocated(hp_phi_srdon)) THEN
        allocate ( hp_phi_srdon(Ngrids) )
      END IF
      IF (.not.allocated(hp_phi_srdop)) THEN
        allocate ( hp_phi_srdop(Ngrids) )
      END IF
      IF (.not.allocated(hp_phi_sldon)) THEN
        allocate ( hp_phi_sldon(Ngrids) )
      END IF
      IF (.not.allocated(hp_phi_sldop)) THEN
        allocate ( hp_phi_sldop(Ngrids) )
      END IF
      IF (.not.allocated(hp_phi_nh4)) THEN
        allocate ( hp_phi_nh4(Ngrids) )
      END IF
      IF (.not.allocated(hp_phi_po4)) THEN
        allocate ( hp_phi_po4(Ngrids) )
      END IF
      IF (.not.allocated(felig_bkg)) THEN
        allocate ( felig_bkg(Ngrids) )
      END IF
      IF (.not.allocated(felig_2_don)) THEN
        allocate ( felig_2_don(Ngrids) )
      END IF
      IF (.not.allocated(fe_2_n_sed)) THEN
        allocate ( fe_2_n_sed(Ngrids) )
      END IF
      IF (.not.allocated(fe_coast)) THEN
        allocate ( fe_coast(Ngrids) )
      END IF
      IF (.not.allocated(alpha_fescav)) THEN
        allocate ( alpha_fescav(Ngrids) )
      END IF
      IF (.not.allocated(beta_fescav)) THEN
        allocate ( beta_fescav(Ngrids) )
      END IF
      IF (.not.allocated(remin_eff_fedet)) THEN
        allocate ( remin_eff_fedet(Ngrids) )
      END IF
      IF (.not.allocated(ki_fescav)) THEN
        allocate ( ki_fescav(Ngrids) )
      END IF
      IF (.not.allocated(io_fescav)) THEN
        allocate ( io_fescav(Ngrids) )
      END IF
      IF (.not.allocated(gamma_fescav)) THEN
        allocate ( gamma_fescav(Ngrids) )
      END IF
      IF (.not.allocated(kfe_eq_lig_ll)) THEN
        allocate ( kfe_eq_lig_ll(Ngrids) )
      END IF
      IF (.not.allocated(kfe_eq_lig_hl)) THEN
        allocate ( kfe_eq_lig_hl(Ngrids) )
      END IF
      IF (.not.allocated(k_o2)) THEN
        allocate ( k_o2(Ngrids) )
      END IF
      IF (.not.allocated(o2_min)) THEN
        allocate ( o2_min(Ngrids) )
      END IF
      IF (.not.allocated(rpcaco3)) THEN
        allocate ( rpcaco3(Ngrids) )
      END IF
      IF (.not.allocated(rplith)) THEN
        allocate ( rplith(Ngrids) )
      END IF
      IF (.not.allocated(rpsio2)) THEN
        allocate ( rpsio2(Ngrids) )
      END IF
      IF (.not.allocated(gamma_ndet)) THEN
        allocate ( gamma_ndet(Ngrids) )
      END IF
      IF (.not.allocated(gamma_cadet_arag)) THEN
        allocate ( gamma_cadet_arag(Ngrids) )
      END IF
      IF (.not.allocated(gamma_cadet_calc)) THEN
        allocate ( gamma_cadet_calc(Ngrids) )
      END IF
      IF (.not.allocated(gamma_sidet)) THEN
        allocate ( gamma_sidet(Ngrids) )
      END IF
      IF (.not.allocated(phi_lith)) THEN
        allocate ( phi_lith(Ngrids) )
      END IF
      IF (.not.allocated(k_lith)) THEN
        allocate ( k_lith(Ngrids) )
      END IF
      IF (.not.allocated(z_sed)) THEN
        allocate ( z_sed(Ngrids) )
      END IF
      IF (.not.allocated(k_no3_denit)) THEN
        allocate ( k_no3_denit(Ngrids) )
      END IF
      IF (.not.allocated(gamma_srdon)) THEN
        allocate ( gamma_srdon(Ngrids) )
      END IF
      IF (.not.allocated(gamma_srdop)) THEN
        allocate ( gamma_srdop(Ngrids) )
      END IF
      IF (.not.allocated(gamma_sldon)) THEN
        allocate ( gamma_sldon(Ngrids) )
      END IF
      IF (.not.allocated(gamma_sldop)) THEN
        allocate ( gamma_sldop(Ngrids) )
      END IF
      IF (.not.allocated(gamma_nitrif)) THEN
        allocate ( gamma_nitrif(Ngrids) )
      END IF
      IF (.not.allocated(irr_inhibit)) THEN
        allocate ( irr_inhibit(Ngrids) )
      END IF
      !IF (.not.allocated(tracer_debug)) THEN
      !  allocate ( tracer_debug(Ngrids) )
      !END IF
      IF (.not.allocated(htotal_in)) THEN
        allocate ( htotal_in(Ngrids) )
      END IF
      IF (.not.allocated(wsink)) THEN
        allocate ( wsink(Ngrids) )
      END IF
!      IF (.not.allocated(ice_restart_file)) THEN
!        allocate ( ice_restart_file(Ngrids) )
!      END IF
!      IF (.not.allocated(ocean_restart_file)) THEN
!        allocate ( ocean_restart_file(Ngrids) )
!      END IF
!      IF (.not.allocated(IC_file)) THEN
!        allocate ( IC_file(Ngrids) )
!      END IF
#ifdef BENTHIC
      IF (.not.allocated(NBeT)) THEN
        allocate ( NBeT(Ngrids) )
      END IF
      IF (.not.allocated(idben)) THEN
        allocate ( idben(NBEN) )
      END IF
      IF (.not.allocated(idBeTvar)) THEN
        allocate ( idBeTvar(NBEN) )
      END IF
      IF (.not.allocated(hisBid)) THEN
        allocate ( hisBid(NBEN,Ngrids) )
      ENDIF
      IF (.not.allocated(avgBid)) THEN
        allocate ( avgBid(NBEN,Ngrids) )
      ENDIF
      IF (.not.allocated(rstBid)) THEN
        allocate ( rstBid(NBEN,Ngrids) )
      ENDIF
#endif

!
!-----------------------------------------------------------------------
!  Initialize tracer identification indices.
!-----------------------------------------------------------------------
!
!  Allocate biological tracer vector.
!
      ! Prognostic variables
      IF (.not.allocated(idbio)) THEN
        allocate ( idbio(NBT) )
      END IF

      ! 2D Diagnostic variables
      IF (.not.allocated(iDbio2)) THEN
        allocate ( iDbio2(NDbio2d) )
      END IF

      ! 3D Diagnostic variables
      IF (.not.allocated(iDbio3)) THEN
        allocate ( iDbio3(NDbio3d) )
      END IF

      ! Sinking material
      IF (.not.allocated(idsink)) THEN
        allocate ( idsink(Nsink) )
      END IF
!
!  Set identification indices.
!

      ic=NAT+NPT+NCS+NNS
      DO i=1,NBT
        idbio(i)=ic+i
      END DO

      ! Nitrogen dynamics
      insm=ic+1
      inlg=ic+2
      indi=ic+3
      insmz=ic+4
      inmdz=ic+5
      inlgz=ic+6
      ildon=ic+7
      isldon=ic+8
      isrdon=ic+9
      inbact=ic+10
      inh4=ic+11
      ino3=ic+12
      indet=ic+13
      ic=ic+13
#ifdef COBALT_MINERALS
      ! Biogenic Minerals and Lithogenic Materials
      isio4=ic+1
      isilg=ic+2
      isidet=ic+3
      icadet_calc=ic+4
      icadet_arag=ic+5
      ilith=ic+6
      ilithdet=ic+7
      ic=ic+7
#endif
#ifdef COBALT_PHOSPHORUS
      ! Phosporus Dynamics
      ildop=ic+1
      isldop=ic+2
      isrdop=ic+3
      ipo4=ic+4
      ipdet=ic+5
      ic=ic+5
#endif
#ifdef COBALT_IRON
      ! Iron Dynamics
      ifesm=ic+1
      ifedi=ic+2
      ifelg=ic+3
      ifed=ic+4
      ifedet=ic+5
      ic=ic+5
#endif
#ifdef COBALT_CARBON
      ! Oxygen, Carbon and Alkalinity
      io2=ic+1
      idic=ic+2
      ialk=ic+3
      ic=ic+3
#endif

      ! 2D Diagnostic variables
      DO i=1,NDbio2d
        iDbio2(i)=i
      END DO

      icased=1
      icadet_arag_btf=2
      icadet_calc_btf=3
      indet_btf=4
      ipdet_btf=5
      isidet_btf=6
      imxl_depth=7
      imxl_level=8

      ialk_btf=9
      idic_btf=10
      ifed_btf=11
      inh4_btf=12
      ino3_btf=13
      io2_btf=14
      ipo4_btf=15
      isio4_btf=16

      ijprod_ndet_100=17
      ijremin_ndet_100=18
      
      ialpha=19
      ico2star=20
      ipco2surf=21
      ico2_flx=22

      io2_flx=23
      iironsed_flx=24

      ! 3D Diagnostic variables
      DO i=1,NDbio3d
        iDbio3(i)=i
      END DO

      ichl=1
      ico3_ion=2
      ihtotal=3
      iirr_mem=4
      ! RD: maybe all the following could be removed someday:
      iirr_mix=5
      iirr_inst=6

      ijprod_cadet_arag=7
      ijprod_cadet_calc=8
      ijprod_fedet=9
      ijprod_lithdet=10
      ijprod_ndet=11
      ijprod_pdet=12
      ijprod_sidet=13

      ijdiss_cadet_arag=14
      ijdiss_cadet_calc=15
      ijremin_ndet=16
      ijremin_pdet=17
      ijremin_fedet=18
      idet_jzloss_n=19
      idet_jzloss_p=20
      idet_jzloss_fe=21
      idet_jhploss_n=22
      idet_jhploss_p=23
      idet_jhploss_fe=24
      

      indet_b4sink=25
      ipdet_b4sink=26
      ifedet_b4sink=27

      indet_afsink=28
      ipdet_afsink=29
      ifedet_afsink=30
      indet_flx=31

      ico3_sol_arag=32
      ico3_sol_calc=33

      ife_bulk_flx=34

      iomega_cadet_calc=35
      iomega_cadet_arag=36
     
      iswdk=37
      
      ! Sediment variables
#ifdef BENTHIC
      DO i=1,Ngrids
         NBeT(i) = NBEN
         NBL(i) = 1
      ENDDO
      DO i=1,NBEN
         idben(i) = i
      ENDDO
      icased=1
      icadet_arag_btf=2
      icadet_calc_btf=3
      indet_btf=4
      ipdet_btf=5
      isidet_btf=6
      
#endif

      idsink(1) = indet
      idsink(2) = isidet
      idsink(3) = icadet_calc
      idsink(4) = icadet_arag
      idsink(5) = ipdet
      idsink(6) = ifedet
      idsink(7) = ilithdet

      RETURN

      END SUBROUTINE initialize_biology

      SUBROUTINE cobalt_alloc_arrays(ng, tile,                          &
     &                               LBi, UBi, LBj, UBj, UBk )


      integer, intent(in) :: ng, tile
      integer, intent(in) :: LBi, UBi, LBj, UBj, UBk

      ! local
      integer :: nphyto, nzoo  ! loop index





     allocate(cobalt%htotallo(LBi:UBi,LBj:UBj))
     allocate(cobalt%htotalhi(LBi:UBi,LBj:UBj))

     !-----------------------------------------------------------------------
     ! allocate arrays for prognostic variables
     !-----------------------------------------------------------------------

     ! Nitrogen Dynamics
     allocate(cobalt%p_nsm(LBi:UBi,LBj:UBj,N(ng),2))   ; cobalt%p_nsm   = 0.0
     allocate(cobalt%p_nlg(LBi:UBi,LBj:UBj,N(ng),2))   ; cobalt%p_nlg   = 0.0
     allocate(cobalt%p_ndi(LBi:UBi,LBj:UBj,N(ng),2))   ; cobalt%p_ndi   = 0.0
     allocate(cobalt%p_nsmz(LBi:UBi,LBj:UBj,N(ng),2))  ; cobalt%p_nsmz  = 0.0
     allocate(cobalt%p_nmdz(LBi:UBi,LBj:UBj,N(ng),2))  ; cobalt%p_nmdz  = 0.0
     allocate(cobalt%p_nlgz(LBi:UBi,LBj:UBj,N(ng),2))  ; cobalt%p_nlgz  = 0.0
     allocate(cobalt%p_ldon(LBi:UBi,LBj:UBj,N(ng),2))  ; cobalt%p_ldon  = 0.0
     allocate(cobalt%p_sldon(LBi:UBi,LBj:UBj,N(ng),2)) ; cobalt%p_sldon = 0.0
     allocate(cobalt%p_srdon(LBi:UBi,LBj:UBj,N(ng),2)) ; cobalt%p_srdon = 0.0
     allocate(cobalt%p_nbact(LBi:UBi,LBj:UBj,N(ng),2)) ; cobalt%p_nbact = 0.0
     allocate(cobalt%p_nh4(LBi:UBi,LBj:UBj,N(ng),2))   ; cobalt%p_nh4   = 0.0
     allocate(cobalt%p_no3(LBi:UBi,LBj:UBj,N(ng),2))   ; cobalt%p_no3   = 0.0
     allocate(cobalt%p_ndet(LBi:UBi,LBj:UBj,N(ng),2))  ; cobalt%p_ndet  = 0.0

#ifdef COBALT_MINERALS
     ! Biogenic Minerals and Lithogenic Materials
     allocate(cobalt%p_sio4(LBi:UBi,LBj:UBj,N(ng),2))       ; cobalt%p_sio4       = 0.0
     allocate(cobalt%p_silg(LBi:UBi,LBj:UBj,N(ng),2))       ; cobalt%p_silg       = 0.0
     allocate(cobalt%p_sidet(LBi:UBi,LBj:UBj,N(ng),2))      ; cobalt%p_sidet      = 0.0
     allocate(cobalt%p_cadet_calc(LBi:UBi,LBj:UBj,N(ng),2)) ; cobalt%p_cadet_calc = 0.0
     allocate(cobalt%p_cadet_arag(LBi:UBi,LBj:UBj,N(ng),2)) ; cobalt%p_cadet_arag = 0.0
     allocate(cobalt%p_lith(LBi:UBi,LBj:UBj,N(ng),2))       ; cobalt%p_lith       = 0.0
     allocate(cobalt%p_lithdet(LBi:UBi,LBj:UBj,N(ng),2))    ; cobalt%p_lithdet    = 0.0
#endif

#ifdef COBALT_PHOSPHORUS
     ! Phosporus Dynamics
     allocate(cobalt%p_ldop(LBi:UBi,LBj:UBj,N(ng),2))  ; cobalt%p_ldop  = 0.0
     allocate(cobalt%p_sldop(LBi:UBi,LBj:UBj,N(ng),2)) ; cobalt%p_sldop = 0.0
     allocate(cobalt%p_srdop(LBi:UBi,LBj:UBj,N(ng),2)) ; cobalt%p_srdop = 0.0
     allocate(cobalt%p_po4(LBi:UBi,LBj:UBj,N(ng),2))   ; cobalt%p_po4   = 0.0
     allocate(cobalt%p_pdet(LBi:UBi,LBj:UBj,N(ng),2))  ; cobalt%p_pdet  = 0.0
#endif

#ifdef COBALT_IRON
     ! Iron Dynamics
     allocate(cobalt%p_fesm(LBi:UBi,LBj:UBj,N(ng),2))   ; cobalt%p_fesm   = 0.0
     allocate(cobalt%p_fedi(LBi:UBi,LBj:UBj,N(ng),2))   ; cobalt%p_fedi   = 0.0
     allocate(cobalt%p_felg(LBi:UBi,LBj:UBj,N(ng),2))   ; cobalt%p_felg   = 0.0
     allocate(cobalt%p_fed(LBi:UBi,LBj:UBj,N(ng),2))    ; cobalt%p_fed    = 0.0
     allocate(cobalt%p_fedet(LBi:UBi,LBj:UBj,N(ng),2))  ; cobalt%p_fedet  = 0.0
#endif

#ifdef COBALT_CARBON
     ! Oxygen, Carbon and Alkalinity
     allocate(cobalt%p_o2(LBi:UBi,LBj:UBj,N(ng),2))  ; cobalt%p_o2  = 0.0
     allocate(cobalt%p_dic(LBi:UBi,LBj:UBj,N(ng),2)) ; cobalt%p_dic = 0.0
     allocate(cobalt%p_alk(LBi:UBi,LBj:UBj,N(ng),2)) ; cobalt%p_alk = 0.0
#endif



!
! allocate and initialize array elements of all phytoplankton groups
! CAS: add fluxes for additional explicit phytoplankton loss terms

      do nphyto = 1, NUM_PHYTO
       allocate(phyto(nphyto)%def_fe(LBi:UBi,LBj:UBj,N(ng)))       ; phyto(nphyto)%def_fe         = 0.0
       allocate(phyto(nphyto)%def_p(LBi:UBi,LBj:UBj,N(ng)))        ; phyto(nphyto)%def_p          = 0.0
       allocate(phyto(nphyto)%f_fe(LBi:UBi,LBj:UBj,N(ng)))         ; phyto(nphyto)%f_fe           = 0.0
       allocate(phyto(nphyto)%f_n(LBi:UBi,LBj:UBj,N(ng)))          ; phyto(nphyto)%f_n            = 0.0
       allocate(phyto(nphyto)%felim(LBi:UBi,LBj:UBj,N(ng)))        ; phyto(nphyto)%felim          = 0.0
       allocate(phyto(nphyto)%irrlim(LBi:UBi,LBj:UBj,N(ng)))       ; phyto(nphyto)%irrlim         = 0.0
       allocate(phyto(nphyto)%jzloss_fe(LBi:UBi,LBj:UBj,N(ng)))    ; phyto(nphyto)%jzloss_fe      = 0.0
       allocate(phyto(nphyto)%jzloss_n(LBi:UBi,LBj:UBj,N(ng)))     ; phyto(nphyto)%jzloss_n       = 0.0
       allocate(phyto(nphyto)%jzloss_p(LBi:UBi,LBj:UBj,N(ng)))     ; phyto(nphyto)%jzloss_p       = 0.0
       allocate(phyto(nphyto)%jzloss_sio2(LBi:UBi,LBj:UBj,N(ng)))  ; phyto(nphyto)%jzloss_sio2    = 0.0
       allocate(phyto(nphyto)%jaggloss_fe(LBi:UBi,LBj:UBj,N(ng)))  ; phyto(nphyto)%jaggloss_fe    = 0.0
       allocate(phyto(nphyto)%jaggloss_n(LBi:UBi,LBj:UBj,N(ng)))   ; phyto(nphyto)%jaggloss_n     = 0.0
       allocate(phyto(nphyto)%jaggloss_p(LBi:UBi,LBj:UBj,N(ng)))   ; phyto(nphyto)%jaggloss_p     = 0.0
       allocate(phyto(nphyto)%jaggloss_sio2(LBi:UBi,LBj:UBj,N(ng))); phyto(nphyto)%jaggloss_sio2  = 0.0
       allocate(phyto(nphyto)%jvirloss_fe(LBi:UBi,LBj:UBj,N(ng)))  ; phyto(nphyto)%jvirloss_fe    = 0.0
       allocate(phyto(nphyto)%jvirloss_n(LBi:UBi,LBj:UBj,N(ng)))   ; phyto(nphyto)%jvirloss_n     = 0.0
       allocate(phyto(nphyto)%jvirloss_p(LBi:UBi,LBj:UBj,N(ng)))   ; phyto(nphyto)%jvirloss_p     = 0.0
       allocate(phyto(nphyto)%jvirloss_sio2(LBi:UBi,LBj:UBj,N(ng))); phyto(nphyto)%jvirloss_sio2  = 0.0
       allocate(phyto(nphyto)%jexuloss_fe(LBi:UBi,LBj:UBj,N(ng)))  ; phyto(nphyto)%jexuloss_fe    = 0.0
       allocate(phyto(nphyto)%jexuloss_n(LBi:UBi,LBj:UBj,N(ng)))   ; phyto(nphyto)%jexuloss_n     = 0.0
       allocate(phyto(nphyto)%jexuloss_p(LBi:UBi,LBj:UBj,N(ng)))   ; phyto(nphyto)%jexuloss_p     = 0.0
       allocate(phyto(nphyto)%jhploss_fe(LBi:UBi,LBj:UBj,N(ng)))   ; phyto(nphyto)%jhploss_fe     = 0.0
       allocate(phyto(nphyto)%jhploss_n(LBi:UBi,LBj:UBj,N(ng)))    ; phyto(nphyto)%jhploss_n      = 0.0
       allocate(phyto(nphyto)%jhploss_p(LBi:UBi,LBj:UBj,N(ng)))    ; phyto(nphyto)%jhploss_p      = 0.0
       allocate(phyto(nphyto)%jhploss_sio2(LBi:UBi,LBj:UBj,N(ng))) ; phyto(nphyto)%jhploss_sio2   = 0.0
       allocate(phyto(nphyto)%juptake_fe(LBi:UBi,LBj:UBj,N(ng)))   ; phyto(nphyto)%juptake_fe     = 0.0
       allocate(phyto(nphyto)%juptake_nh4(LBi:UBi,LBj:UBj,N(ng)))  ; phyto(nphyto)%juptake_nh4    = 0.0
       allocate(phyto(nphyto)%juptake_no3(LBi:UBi,LBj:UBj,N(ng)))  ; phyto(nphyto)%juptake_no3    = 0.0
       allocate(phyto(nphyto)%juptake_po4(LBi:UBi,LBj:UBj,N(ng)))  ; phyto(nphyto)%juptake_po4    = 0.0
       allocate(phyto(nphyto)%jprod_n(LBi:UBi,LBj:UBj,N(ng)))      ; phyto(nphyto)%jprod_n        = 0.0
       allocate(phyto(nphyto)%liebig_lim(LBi:UBi,LBj:UBj,N(ng)))   ; phyto(nphyto)%liebig_lim     = 0.0
       allocate(phyto(nphyto)%mu(LBi:UBi,LBj:UBj,N(ng)))           ; phyto(nphyto)%mu             = 0.0
       allocate(phyto(nphyto)%po4lim(LBi:UBi,LBj:UBj,N(ng)))       ; phyto(nphyto)%po4lim         = 0.0
       allocate(phyto(nphyto)%q_fe_2_n(LBi:UBi,LBj:UBj,N(ng)))     ; phyto(nphyto)%q_fe_2_n       = 0.0
       allocate(phyto(nphyto)%q_p_2_n(LBi:UBi,LBj:UBj,N(ng)))      ; phyto(nphyto)%q_p_2_n        = 0.0
       allocate(phyto(nphyto)%q_si_2_n(LBi:UBi,LBj:UBj,N(ng)))     ; phyto(nphyto)%q_si_2_n       = 0.0
       allocate(phyto(nphyto)%theta(LBi:UBi,LBj:UBj,N(ng)))        ; phyto(nphyto)%theta          = 0.0
      enddo
!
! allocate and initialize array elements of only some phytoplankton groups
!
      do nphyto = 2, NUM_PHYTO
       allocate(phyto(nphyto)%nh4lim(LBi:UBi,LBj:UBj,N(ng)))      ; phyto(nphyto)%nh4lim          = 0.0
       allocate(phyto(nphyto)%no3lim(LBi:UBi,LBj:UBj,N(ng)))      ; phyto(nphyto)%no3lim          = 0.0
      enddo
!
! allocate and initialize array elements of only one phytoplankton group
!
     allocate(phyto(DIAZO)%juptake_n2(LBi:UBi,LBj:UBj,N(ng)))   ; phyto(DIAZO)%juptake_n2   = 0.0
     allocate(phyto(DIAZO)%o2lim(LBi:UBi,LBj:UBj,N(ng)))        ; phyto(DIAZO)%o2lim        = 0.0
     allocate(phyto(LARGE)%juptake_sio4(LBi:UBi,LBj:UBj,N(ng))) ; phyto(LARGE)%juptake_sio4 = 0.0
     allocate(phyto(LARGE)%silim(LBi:UBi,LBj:UBj,N(ng)))        ; phyto(LARGE)%silim      = 0.0
!
! allocate and initialize arrays for bacteria
!
     allocate(bact(1)%f_n(LBi:UBi,LBj:UBj,N(ng)))              ; bact(1)%f_n             = 0.0
     allocate(bact(1)%jzloss_n(LBi:UBi,LBj:UBj,N(ng)))         ; bact(1)%jzloss_n        = 0.0
     allocate(bact(1)%jzloss_p(LBi:UBi,LBj:UBj,N(ng)))         ; bact(1)%jzloss_p        = 0.0
     allocate(bact(1)%jvirloss_n(LBi:UBi,LBj:UBj,N(ng)))       ; bact(1)%jvirloss_n      = 0.0
     allocate(bact(1)%jvirloss_p(LBi:UBi,LBj:UBj,N(ng)))       ; bact(1)%jvirloss_p      = 0.0
     allocate(bact(1)%jhploss_n(LBi:UBi,LBj:UBj,N(ng)))        ; bact(1)%jhploss_n       = 0.0
     allocate(bact(1)%jhploss_p(LBi:UBi,LBj:UBj,N(ng)))        ; bact(1)%jhploss_p       = 0.0
     allocate(bact(1)%juptake_ldon(LBi:UBi,LBj:UBj,N(ng)))     ; bact(1)%juptake_ldon    = 0.0
     allocate(bact(1)%juptake_ldop(LBi:UBi,LBj:UBj,N(ng)))     ; bact(1)%juptake_ldop    = 0.0
     allocate(bact(1)%jprod_nh4(LBi:UBi,LBj:UBj,N(ng)))        ; bact(1)%jprod_nh4       = 0.0
     allocate(bact(1)%jprod_po4(LBi:UBi,LBj:UBj,N(ng)))        ; bact(1)%jprod_po4       = 0.0
     allocate(bact(1)%jprod_n(LBi:UBi,LBj:UBj,N(ng)))          ; bact(1)%jprod_n      = 0.0
     allocate(bact(1)%temp_lim(LBi:UBi,LBj:UBj,N(ng)))         ; bact(1)%temp_lim        = 0.0
!
! CAS: allocate and initialize array elements for all zooplankton groups
!
      do nzoo = 1, NUM_ZOO
       allocate(zoo(nzoo)%f_n(LBi:UBi,LBj:UBj,N(ng)))           ; zoo(nzoo)%f_n            = 0.0
       allocate(zoo(nzoo)%jzloss_n(LBi:UBi,LBj:UBj,N(ng)))      ; zoo(nzoo)%jzloss_n       = 0.0
       allocate(zoo(nzoo)%jzloss_p(LBi:UBi,LBj:UBj,N(ng)))      ; zoo(nzoo)%jzloss_p       = 0.0
       allocate(zoo(nzoo)%jhploss_n(LBi:UBi,LBj:UBj,N(ng)))     ; zoo(nzoo)%jhploss_n      = 0.0
       allocate(zoo(nzoo)%jhploss_p(LBi:UBi,LBj:UBj,N(ng)))     ; zoo(nzoo)%jhploss_p      = 0.0
       allocate(zoo(nzoo)%jingest_n(LBi:UBi,LBj:UBj,N(ng)))     ; zoo(nzoo)%jingest_n      = 0.0
       allocate(zoo(nzoo)%jingest_p(LBi:UBi,LBj:UBj,N(ng)))     ; zoo(nzoo)%jingest_p      = 0.0
       allocate(zoo(nzoo)%jingest_sio2(LBi:UBi,LBj:UBj,N(ng)))  ; zoo(nzoo)%jingest_sio2   = 0.0
       allocate(zoo(nzoo)%jingest_fe(LBi:UBi,LBj:UBj,N(ng)))    ; zoo(nzoo)%jingest_fe     = 0.0
       allocate(zoo(nzoo)%jprod_ndet(LBi:UBi,LBj:UBj,N(ng)))    ; zoo(nzoo)%jprod_ndet     = 0.0
       allocate(zoo(nzoo)%jprod_pdet(LBi:UBi,LBj:UBj,N(ng)))    ; zoo(nzoo)%jprod_pdet     = 0.0
       allocate(zoo(nzoo)%jprod_ldon(LBi:UBi,LBj:UBj,N(ng)))    ; zoo(nzoo)%jprod_ldon     = 0.0
       allocate(zoo(nzoo)%jprod_ldop(LBi:UBi,LBj:UBj,N(ng)))    ; zoo(nzoo)%jprod_ldop     = 0.0
       allocate(zoo(nzoo)%jprod_srdon(LBi:UBi,LBj:UBj,N(ng)))    ; zoo(nzoo)%jprod_srdon     = 0.0
       allocate(zoo(nzoo)%jprod_srdop(LBi:UBi,LBj:UBj,N(ng)))    ; zoo(nzoo)%jprod_srdop     = 0.0
       allocate(zoo(nzoo)%jprod_sldon(LBi:UBi,LBj:UBj,N(ng)))    ; zoo(nzoo)%jprod_sldon     = 0.0
       allocate(zoo(nzoo)%jprod_sldop(LBi:UBi,LBj:UBj,N(ng)))    ; zoo(nzoo)%jprod_sldop     = 0.0
       allocate(zoo(nzoo)%jprod_fedet(LBi:UBi,LBj:UBj,N(ng)))   ; zoo(nzoo)%jprod_fedet    = 0.0
       allocate(zoo(nzoo)%jprod_fed(LBi:UBi,LBj:UBj,N(ng)))     ; zoo(nzoo)%jprod_fed      = 0.0
       allocate(zoo(nzoo)%jprod_sidet(LBi:UBi,LBj:UBj,N(ng)))   ; zoo(nzoo)%jprod_sidet    = 0.0
       allocate(zoo(nzoo)%jprod_sio4(LBi:UBi,LBj:UBj,N(ng)))   ; zoo(nzoo)%jprod_sio4      = 0.0
       allocate(zoo(nzoo)%jprod_po4(LBi:UBi,LBj:UBj,N(ng)))     ; zoo(nzoo)%jprod_po4      = 0.0
       allocate(zoo(nzoo)%jprod_nh4(LBi:UBi,LBj:UBj,N(ng)))     ; zoo(nzoo)%jprod_nh4      = 0.0
       allocate(zoo(nzoo)%jprod_n(LBi:UBi,LBj:UBj,N(ng)))      ; zoo(nzoo)%jprod_n       = 0.0
       allocate(zoo(nzoo)%temp_lim(LBi:UBi,LBj:UBj,N(ng)))      ; zoo(nzoo)%temp_lim       = 0.0
      enddo

! higher predator ingestion
     allocate(cobalt%hp_jingest_n(LBi:UBi,LBj:UBj,N(ng)))     ; cobalt%hp_jingest_n      = 0.0
     allocate(cobalt%hp_jingest_p(LBi:UBi,LBj:UBj,N(ng)))     ; cobalt%hp_jingest_p      = 0.0
     allocate(cobalt%hp_jingest_sio2(LBi:UBi,LBj:UBj,N(ng)))  ; cobalt%hp_jingest_sio2   = 0.0
     allocate(cobalt%hp_jingest_fe(LBi:UBi,LBj:UBj,N(ng)))    ; cobalt%hp_jingest_fe     = 0.0 

     allocate(cobalt%f_temp(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%f_temp=0.0
     allocate(cobalt%f_salt(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%f_salt=0.0
     allocate(cobalt%f_alk(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%f_alk=0.0
     allocate(cobalt%f_cadet_arag(LBi:UBi, LBj:UBj, 1:N(ng))) ; cobalt%f_cadet_arag=0.0
     allocate(cobalt%f_cadet_calc(LBi:UBi, LBj:UBj, 1:N(ng))) ; cobalt%f_cadet_calc=0.0
     allocate(cobalt%f_dic(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%f_dic=0.0
     allocate(cobalt%f_fed(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%f_fed=0.0
     allocate(cobalt%f_fedet(LBi:UBi, LBj:UBj, 1:N(ng)))      ; cobalt%f_fedet=0.0
     allocate(cobalt%f_ldon(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%f_ldon=0.0
     allocate(cobalt%f_ldop(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%f_ldop=0.0
     allocate(cobalt%f_lith(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%f_lith=0.0
     allocate(cobalt%f_lithdet(LBi:UBi, LBj:UBj, 1:N(ng)))    ; cobalt%f_lithdet=0.0
     allocate(cobalt%f_ndet(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%f_ndet=0.0
     allocate(cobalt%f_nh4(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%f_nh4=0.0
     allocate(cobalt%f_no3(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%f_no3=0.0
     allocate(cobalt%f_o2(LBi:UBi, LBj:UBj, 1:N(ng)))         ; cobalt%f_o2=0.0
     allocate(cobalt%f_pdet(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%f_pdet=0.0
     allocate(cobalt%f_po4(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%f_po4=0.0
     allocate(cobalt%f_srdon(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%f_srdon=0.0
     allocate(cobalt%f_srdop(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%f_srdop=0.0
     allocate(cobalt%f_sldon(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%f_sldon=0.0
     allocate(cobalt%f_sldop(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%f_sldop=0.0
     allocate(cobalt%f_sidet(LBi:UBi, LBj:UBj, 1:N(ng)))      ; cobalt%f_sidet=0.0
     allocate(cobalt%f_silg(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%f_silg=0.0
     allocate(cobalt%f_sio4(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%f_sio4=0.0
     allocate(cobalt%co3_sol_arag(LBi:UBi, LBj:UBj, 1:N(ng))) ; cobalt%co3_sol_arag=0.0
     allocate(cobalt%co3_sol_calc(LBi:UBi, LBj:UBj, 1:N(ng))) ; cobalt%co3_sol_calc=0.0
     allocate(cobalt%omega_arag(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%omega_arag=0.0
     allocate(cobalt%omega_calc(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%omega_calc=0.0
     allocate(cobalt%f_chl(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%f_chl=0.0
     allocate(cobalt%f_co3_ion(LBi:UBi, LBj:UBj, 1:N(ng)))    ; cobalt%f_co3_ion=0.0
     allocate(cobalt%f_htotal(LBi:UBi, LBj:UBj, 1:N(ng)))     ; cobalt%f_htotal=0.0
     allocate(cobalt%f_irr_mem(LBi:UBi, LBj:UBj, 1:N(ng)))    ; cobalt%f_irr_mem=0.0
     allocate(cobalt%f_cased(LBi:UBi, LBj:UBj, 1:N(ng)))      ; cobalt%f_cased=0.0
     allocate(cobalt%f_cadet_arag_btf(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%f_cadet_arag_btf=0.0
     allocate(cobalt%f_cadet_calc_btf(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%f_cadet_calc_btf=0.0
     allocate(cobalt%f_fedet_btf(LBi:UBi, LBj:UBj, 1:N(ng)))  ; cobalt%f_fedet_btf=0.0
     allocate(cobalt%f_lithdet_btf(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%f_lithdet_btf=0.0
     allocate(cobalt%f_ndet_btf(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%f_ndet_btf=0.0
     allocate(cobalt%f_pdet_btf(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%f_pdet_btf=0.0
     allocate(cobalt%f_sidet_btf(LBi:UBi, LBj:UBj, 1:N(ng)))  ; cobalt%f_sidet_btf=0.0

     allocate(cobalt%jndi(LBi:UBi, LBj:UBj, 1:N(ng)))         ; cobalt%jndi=0.0
     allocate(cobalt%jnsm(LBi:UBi, LBj:UBj, 1:N(ng)))         ; cobalt%jnsm=0.0
     allocate(cobalt%jnlg(LBi:UBi, LBj:UBj, 1:N(ng)))         ; cobalt%jnlg=0.0
     allocate(cobalt%jnbact(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%jnbact=0.0
     allocate(cobalt%jnsmz(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jnsmz=0.0
     allocate(cobalt%jnmdz(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jnmdz=0.0
     allocate(cobalt%jnlgz(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jnlgz=0.0
     allocate(cobalt%jalk(LBi:UBi, LBj:UBj, 1:N(ng)))         ; cobalt%jalk=0.0
     allocate(cobalt%jcadet_arag(LBi:UBi, LBj:UBj, 1:N(ng)))  ; cobalt%jcadet_arag=0.0
     allocate(cobalt%jcadet_calc(LBi:UBi, LBj:UBj, 1:N(ng)))  ; cobalt%jcadet_calc=0.0
     allocate(cobalt%jdic(LBi:UBi, LBj:UBj, 1:N(ng)))         ; cobalt%jdic=0.0
     allocate(cobalt%jfed(LBi:UBi, LBj:UBj, 1:N(ng)))         ; cobalt%jfed=0.0
     allocate(cobalt%jfedi(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jfedi=0.0
     allocate(cobalt%jfelg(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jfelg=0.0
     allocate(cobalt%jfesm(LBi:UBi, LBj:UBj, 1:N(ng)))     ; cobalt%jfesm=0.0
     allocate(cobalt%jfedet(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%jfedet=0.0
     allocate(cobalt%jldon(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jldon=0.0
     allocate(cobalt%jldop(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jldop=0.0
     allocate(cobalt%jlith(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jlith=0.0
     allocate(cobalt%jlithdet(LBi:UBi, LBj:UBj, 1:N(ng)))     ; cobalt%jlithdet=0.0
     allocate(cobalt%jndet(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jndet=0.0
     allocate(cobalt%jnh4(LBi:UBi, LBj:UBj, 1:N(ng)))         ; cobalt%jnh4=0.0
     allocate(cobalt%jno3(LBi:UBi, LBj:UBj, 1:N(ng)))         ; cobalt%jno3=0.0
     allocate(cobalt%jo2(LBi:UBi, LBj:UBj, 1:N(ng)))          ; cobalt%jo2=0.0
     allocate(cobalt%jpdet(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jpdet=0.0
     allocate(cobalt%jpo4(LBi:UBi, LBj:UBj, 1:N(ng)))         ; cobalt%jpo4=0.0
     allocate(cobalt%jsrdon(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jsrdon=0.0
     allocate(cobalt%jsrdop(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jsrdop=0.0
     allocate(cobalt%jsldon(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jsldon=0.0
     allocate(cobalt%jsldop(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jsldop=0.0
     allocate(cobalt%jsidet(LBi:UBi, LBj:UBj, 1:N(ng)))       ; cobalt%jsidet=0.0
     allocate(cobalt%jsilg(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jsilg=0.0
     allocate(cobalt%jsio4(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%jsio4=0.0
     allocate(cobalt%jprod_ndet(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%jprod_ndet=0.0
     allocate(cobalt%jprod_pdet(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%jprod_pdet=0.0
     allocate(cobalt%jprod_srdon(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%jprod_srdon=0.0
     allocate(cobalt%jprod_sldon(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%jprod_sldon=0.0
     allocate(cobalt%jprod_ldon(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%jprod_ldon=0.0
     allocate(cobalt%jprod_srdop(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%jprod_srdop=0.0
     allocate(cobalt%jprod_sldop(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%jprod_sldop=0.0
     allocate(cobalt%jprod_ldop(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%jprod_ldop=0.0
     allocate(cobalt%jprod_fedet(LBi:UBi, LBj:UBj, 1:N(ng)))  ; cobalt%jprod_fedet=0.0
     allocate(cobalt%jprod_fed(LBi:UBi, LBj:UBj, 1:N(ng)))    ; cobalt%jprod_fed=0.0
     allocate(cobalt%jprod_sidet(LBi:UBi, LBj:UBj, 1:N(ng)))  ; cobalt%jprod_sidet=0.0
     allocate(cobalt%jprod_sio4(LBi:UBi, LBj:UBj, 1:N(ng)))  ; cobalt%jprod_sio4=0.0
     allocate(cobalt%jprod_lithdet(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%jprod_lithdet=0.0
     allocate(cobalt%jprod_cadet_arag(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%jprod_cadet_arag=0.0
     allocate(cobalt%jprod_cadet_calc(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%jprod_cadet_calc=0.0
     allocate(cobalt%jprod_nh4(LBi:UBi, LBj:UBj, 1:N(ng)))    ; cobalt%jprod_nh4=0.0
     allocate(cobalt%jprod_po4(LBi:UBi, LBj:UBj, 1:N(ng)))    ; cobalt%jprod_po4=0.0
     allocate(cobalt%det_jzloss_n(LBi:UBi, LBj:UBj, 1:N(ng))) ; cobalt%det_jzloss_n=0.0
     allocate(cobalt%det_jzloss_p(LBi:UBi, LBj:UBj, 1:N(ng))) ; cobalt%det_jzloss_p=0.0
     allocate(cobalt%det_jzloss_fe(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%det_jzloss_fe=0.0
     allocate(cobalt%det_jzloss_si(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%det_jzloss_si=0.0
     allocate(cobalt%det_jhploss_n(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%det_jhploss_n=0.0
     allocate(cobalt%det_jhploss_p(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%det_jhploss_p=0.0
     allocate(cobalt%det_jhploss_fe(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%det_jhploss_fe=0.0
     allocate(cobalt%det_jhploss_si(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%det_jhploss_si=0.0
     allocate(cobalt%jdiss_cadet_arag(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%jdiss_cadet_arag=0.0
     allocate(cobalt%jdiss_cadet_calc(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%jdiss_cadet_calc=0.0
     allocate(cobalt%jdiss_sidet(LBi:UBi, LBj:UBj, 1:N(ng)))  ; cobalt%jdiss_sidet=0.0
     allocate(cobalt%jremin_ndet(LBi:UBi, LBj:UBj, 1:N(ng)))  ; cobalt%jremin_ndet=0.0
     allocate(cobalt%jremin_pdet(LBi:UBi, LBj:UBj, 1:N(ng)))  ; cobalt%jremin_pdet=0.0
     allocate(cobalt%jremin_fedet(LBi:UBi, LBj:UBj, 1:N(ng))) ; cobalt%jremin_fedet=0.0
     allocate(cobalt%jfe_ads(LBi:UBi, LBj:UBj, 1:N(ng)))      ; cobalt%jfe_ads=0.0
     allocate(cobalt%jfe_coast(LBi:UBi, LBj:UBj, 1:N(ng)))    ; cobalt%jfe_coast=0.0
     allocate(cobalt%kfe_eq_lig(LBi:UBi, LBj:UBj, 1:N(ng)))   ; cobalt%kfe_eq_lig=0.0
     allocate(cobalt%expkT(LBi:UBi, LBj:UBj, 1:N(ng)))        ; cobalt%expkT=0.0
     allocate(cobalt%hp_temp_lim(LBi:UBi, LBj:UBj, 1:N(ng)))  ; cobalt%hp_temp_lim=0.0
     allocate(cobalt%irr_inst(LBi:UBi, LBj:UBj, 1:N(ng)))     ; cobalt%irr_inst=0.0
     allocate(cobalt%irr_mix(LBi:UBi, LBj:UBj, 1:N(ng)))      ; cobalt%irr_mix=0.0
     allocate(cobalt%jno3denit_wc(LBi:UBi, LBj:UBj, 1:N(ng))) ; cobalt%jno3denit_wc=0.0
     allocate(cobalt%jnitrif(LBi:UBi, LBj:UBj, 1:N(ng)))      ; cobalt%jnitrif=0.0
     allocate(cobalt%total_filter_feeding(LBi:UBi,LBj:UBj,1:N(ng))); cobalt%total_filter_feeding=0.0
     allocate(cobalt%zt(LBi:UBi, LBj:UBj, 1:N(ng)))           ; cobalt%zt=0.0
     allocate(cobalt%zm(LBi:UBi, LBj:UBj, 1:N(ng)))           ; cobalt%zm=0.0
     allocate(cobalt%tot_layer_int_c(LBi:UBi, LBj:UBj,1:N(ng)))  ; cobalt%tot_layer_int_c=0.0
     allocate(cobalt%tot_layer_int_fe(LBi:UBi, LBj:UBj,1:N(ng))) ; cobalt%tot_layer_int_fe=0.0
     allocate(cobalt%tot_layer_int_n(LBi:UBi, LBj:UBj, 1:N(ng))) ; cobalt%tot_layer_int_n=0.0
     allocate(cobalt%tot_layer_int_p(LBi:UBi, LBj:UBj, 1:N(ng))) ; cobalt%tot_layer_int_p=0.0
     allocate(cobalt%tot_layer_int_si(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%tot_layer_int_si=0.0
     allocate(cobalt%net_prim_prod(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%net_prim_prod=0.0
     allocate(cobalt%gross_prim_prod(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%gross_prim_prod=0.0
     allocate(cobalt%nlg_diatoms(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%nlg_diatoms=0.0
     allocate(cobalt%q_si_2_n_lg_diatoms(LBi:UBi, LBj:UBj, 1:N(ng))); cobalt%q_si_2_n_lg_diatoms=0.0
     allocate(cobalt%b_alk(LBi:UBi, LBj:UBj))              ; cobalt%b_alk=0.0
     allocate(cobalt%b_dic(LBi:UBi, LBj:UBj))              ; cobalt%b_dic=0.0
     allocate(cobalt%b_fed(LBi:UBi, LBj:UBj))              ; cobalt%b_fed=0.0
     allocate(cobalt%b_nh4(LBi:UBi, LBj:UBj))              ; cobalt%b_nh4=0.0
     allocate(cobalt%b_no3(LBi:UBi, LBj:UBj))              ; cobalt%b_no3=0.0
     allocate(cobalt%b_o2(LBi:UBi, LBj:UBj))               ; cobalt%b_o2=0.0
     allocate(cobalt%b_po4(LBi:UBi, LBj:UBj))              ; cobalt%b_po4=0.0
     allocate(cobalt%b_sio4(LBi:UBi, LBj:UBj))             ; cobalt%b_sio4=0.0
     allocate(cobalt%pco2_csurf(LBi:UBi, LBj:UBj))         ; cobalt%pco2_csurf=0.0
     allocate(cobalt%co2_csurf(LBi:UBi, LBj:UBj))          ; cobalt%co2_csurf=0.0
     allocate(cobalt%co2_alpha(LBi:UBi, LBj:UBj))          ; cobalt%co2_alpha=0.0
     allocate(cobalt%fcadet_arag_btm(LBi:UBi, LBj:UBj))    ; cobalt%fcadet_arag_btm=0.0
     allocate(cobalt%fcadet_calc_btm(LBi:UBi, LBj:UBj))    ; cobalt%fcadet_calc_btm=0.0
     allocate(cobalt%ffedet_btm(LBi:UBi, LBj:UBj))         ; cobalt%ffedet_btm=0.0
     allocate(cobalt%flithdet_btm(LBi:UBi, LBj:UBj))       ; cobalt%flithdet_btm=0.0
     allocate(cobalt%fpdet_btm(LBi:UBi, LBj:UBj))          ; cobalt%fpdet_btm=0.0
     allocate(cobalt%fndet_btm(LBi:UBi, LBj:UBj))          ; cobalt%fndet_btm=0.0
     allocate(cobalt%fsidet_btm(LBi:UBi, LBj:UBj))         ; cobalt%fsidet_btm=0.0
     allocate(cobalt%fcased_burial(LBi:UBi, LBj:UBj))      ; cobalt%fcased_burial=0.0
     allocate(cobalt%fcased_input(LBi:UBi, LBj:UBj))       ; cobalt%fcased_input=0.0
     allocate(cobalt%fcased_redis(LBi:UBi, LBj:UBj))       ; cobalt%fcased_redis=0.0
     allocate(cobalt%ffe_sed(LBi:UBi, LBj:UBj))            ; cobalt%ffe_sed=0.0
     allocate(cobalt%fnfeso4red_sed(LBi:UBi, LBj:UBj))     ; cobalt%fnfeso4red_sed=0.0
     allocate(cobalt%fno3denit_sed(LBi:UBi, LBj:UBj))      ; cobalt%fno3denit_sed=0.0
     allocate(cobalt%fnoxic_sed(LBi:UBi, LBj:UBj))         ; cobalt%fnoxic_sed=0.0
     allocate(cobalt%frac_burial(LBi:UBi, LBj:UBj))        ; cobalt%frac_burial=0.0
     allocate(cobalt%fndet_burial(LBi:UBi, LBj:UBj))       ; cobalt%fndet_burial=0.0
     allocate(cobalt%fpdet_burial(LBi:UBi, LBj:UBj))       ; cobalt%fpdet_burial=0.0

!
! allocate 100m integrated quantities
!
      do nphyto = 1, NUM_PHYTO
       allocate(phyto(nphyto)%jprod_n_100(LBi:UBi,LBj:UBj))      ; phyto(nphyto)%jprod_n_100      = 0.0
       allocate(phyto(nphyto)%jprod_n_new_100(LBi:UBi,LBj:UBj))  ; phyto(nphyto)%jprod_n_new_100  = 0.0
       allocate(phyto(nphyto)%jzloss_n_100(LBi:UBi,LBj:UBj))     ; phyto(nphyto)%jzloss_n_100  = 0.0
       allocate(phyto(nphyto)%jexuloss_n_100(LBi:UBi,LBj:UBj))   ; phyto(nphyto)%jexuloss_n_100  = 0.0
       allocate(phyto(nphyto)%f_n_100(LBi:UBi,LBj:UBj))          ; phyto(nphyto)%f_n_100  = 0.0
      enddo
     allocate(phyto(DIAZO)%jprod_n_n2_100(LBi:UBi,LBj:UBj)); phyto(DIAZO)%jprod_n_n2_100 = 0.0
     allocate(phyto(SMALL)%jvirloss_n_100(LBi:UBi,LBj:UBj))  ; phyto(SMALL)%jvirloss_n_100 = 0.0
     allocate(phyto(SMALL)%jaggloss_n_100(LBi:UBi,LBj:UBj))  ; phyto(SMALL)%jaggloss_n_100 = 0.0
     allocate(phyto(LARGE)%jaggloss_n_100(LBi:UBi,LBj:UBj))  ; phyto(LARGE)%jaggloss_n_100 = 0.0
     allocate(cobalt%jprod_allphytos_100(LBi:UBi,LBj:UBj))   ; cobalt%jprod_allphytos_100 = 0.0

      do nzoo = 1, NUM_ZOO
       allocate(zoo(nzoo)%jprod_n_100(LBi:UBi,LBj:UBj))      ; zoo(nzoo)%jprod_n_100      = 0.0
       allocate(zoo(nzoo)%jingest_n_100(LBi:UBi,LBj:UBj))    ; zoo(nzoo)%jingest_n_100    = 0.0
       allocate(zoo(nzoo)%jremin_n_100(LBi:UBi,LBj:UBj))     ; zoo(nzoo)%jremin_n_100     = 0.0
       allocate(zoo(nzoo)%f_n_100(LBi:UBi,LBj:UBj))          ; zoo(nzoo)%f_n_100          = 0.0
      enddo

      do nzoo = 1,2
       allocate(zoo(nzoo)%jzloss_n_100(LBi:UBi,LBj:UBj))     ; zoo(nzoo)%jzloss_n_100     = 0.0
       allocate(zoo(nzoo)%jprod_don_100(LBi:UBi,LBj:UBj))    ; zoo(nzoo)%jprod_don_100    = 0.0
      enddo

      do nzoo = 2,3
       allocate(zoo(nzoo)%jhploss_n_100(LBi:UBi,LBj:UBj))    ; zoo(nzoo)%jhploss_n_100     = 0.0
       allocate(zoo(nzoo)%jprod_ndet_100(LBi:UBi,LBj:UBj))   ; zoo(nzoo)%jprod_ndet_100    = 0.0
      enddo

     allocate(cobalt%hp_jingest_n_100(LBi:UBi,LBj:UBj))    ; cobalt%hp_jingest_n_100    = 0.0
     allocate(cobalt%hp_jremin_n_100(LBi:UBi,LBj:UBj))     ; cobalt%hp_jremin_n_100     = 0.0
     allocate(cobalt%hp_jprod_ndet_100(LBi:UBi,LBj:UBj))   ; cobalt%hp_jprod_ndet_100   = 0.0

     allocate(bact(1)%jprod_n_100(LBi:UBi,LBj:UBj))   ; bact(1)%jprod_n_100 = 0.0
     allocate(bact(1)%jzloss_n_100(LBi:UBi,LBj:UBj))  ; bact(1)%jzloss_n_100 = 0.0
     allocate(bact(1)%jvirloss_n_100(LBi:UBi,LBj:UBj)); bact(1)%jvirloss_n_100 = 0.0
     allocate(bact(1)%jremin_n_100(LBi:UBi,LBj:UBj))  ; bact(1)%jremin_n_100 = 0.0
     allocate(bact(1)%juptake_ldon_100(LBi:UBi,LBj:UBj)) ; bact(1)%juptake_ldon_100 = 0.0
     allocate(bact(1)%f_n_100(LBi:UBi,LBj:UBj))       ; bact(1)%f_n_100 = 0.0

     allocate(cobalt%jprod_lithdet_100(LBi:UBi,LBj:UBj))      ; cobalt%jprod_lithdet_100 = 0.0
     allocate(cobalt%jprod_sidet_100(LBi:UBi,LBj:UBj))        ; cobalt%jprod_sidet_100 = 0.0
     allocate(cobalt%jprod_cadet_calc_100(LBi:UBi,LBj:UBj))   ; cobalt%jprod_cadet_calc_100 = 0.0
     allocate(cobalt%jprod_cadet_arag_100(LBi:UBi,LBj:UBj))   ; cobalt%jprod_cadet_arag_100 = 0.0
     allocate(cobalt%jremin_ndet_100(LBi:UBi,LBj:UBj))        ; cobalt%jremin_ndet_100 = 0.0
     allocate(cobalt%jprod_mesozoo_200(LBi:UBi,LBj:UBj))      ; cobalt%jprod_mesozoo_200 = 0.0

     allocate(cobalt%f_ndet_100(LBi:UBi,LBj:UBj))             ; cobalt%f_ndet_100 = 0.0
     allocate(cobalt%f_don_100(LBi:UBi,LBj:UBj))              ; cobalt%f_don_100  = 0.0
     allocate(cobalt%f_silg_100(LBi:UBi,LBj:UBj))             ; cobalt%f_silg_100 = 0.0
     allocate(cobalt%f_mesozoo_200(LBi:UBi,LBj:UBj))          ; cobalt%f_mesozoo_200 = 0.0

     allocate(cobalt%fndet_100(LBi:UBi,LBj:UBj))             ; cobalt%fndet_100 = 0.0
     allocate(cobalt%fpdet_100(LBi:UBi,LBj:UBj))             ; cobalt%fpdet_100 = 0.0
     allocate(cobalt%fsidet_100(LBi:UBi,LBj:UBj))            ; cobalt%fsidet_100 = 0.0
     allocate(cobalt%flithdet_100(LBi:UBi,LBj:UBj))          ; cobalt%flithdet_100 = 0.0
     allocate(cobalt%fcadet_calc_100(LBi:UBi,LBj:UBj))       ; cobalt%fcadet_calc_100 = 0.0
     allocate(cobalt%fcadet_arag_100(LBi:UBi,LBj:UBj))       ; cobalt%fcadet_arag_100 = 0.0
     allocate(cobalt%ffedet_100(LBi:UBi,LBj:UBj))            ; cobalt%ffedet_100 = 0.0

     allocate(cobalt%btm_temp(LBi:UBi,LBj:UBj))            ; cobalt%btm_temp = 0.0
     allocate(cobalt%btm_o2(LBi:UBi,LBj:UBj))            ; cobalt%btm_o2 = 0.0

      RETURN

      END SUBROUTINE cobalt_alloc_arrays

      SUBROUTINE cobalt_add_params(ng)

      integer, intent(in) :: ng

      cobalt%htotal_scale_lo = htotal_scale_lo(ng)
      cobalt%htotal_scale_hi = htotal_scale_hi(ng)
      cobalt%Rho_0           = RHO_0(ng)
      cobalt%nkml            = NKML(ng)
      cobalt%a_0             = a_0(ng)
      cobalt%a_1             = a_1(ng)
      cobalt%a_2             = a_2(ng)
      cobalt%a_3             = a_3(ng)
      cobalt%a_4             = a_4(ng)
      cobalt%a_5             = a_5(ng)
      cobalt%b_0             = b_0(ng)
      cobalt%b_1             = b_1(ng)
      cobalt%b_2             = b_2(ng)
      cobalt%b_3             = b_3(ng)
      cobalt%c_0             = c_0(ng)
      cobalt%a1_co2          = a1_co2(ng)
      cobalt%a2_co2          = a2_co2(ng)
      cobalt%a3_co2          = a3_co2(ng)
      cobalt%a4_co2          = a4_co2(ng)
      cobalt%a1_o2           = a1_o2(ng)
      cobalt%a2_o2           = a2_o2(ng)
      cobalt%a3_o2           = a3_o2(ng)
      cobalt%a4_o2           = a4_o2(ng)
      cobalt%mass_2_n        = mass_2_n(ng)
      cobalt%n_2_n_denit     = n_2_n_denit(ng)
      cobalt%o2_2_c          = o2_2_c(ng)
      cobalt%o2_2_nfix       = o2_2_nfix(ng)
      cobalt%o2_2_nh4        = o2_2_nh4(ng)
      cobalt%o2_2_nitrif     = o2_2_nitrif(ng)
      cobalt%o2_2_no3        = o2_2_no3(ng)
      phyto(DIAZO)%k_fed     = k_fed_Di(ng)
      phyto(LARGE)%k_fed     = k_fed_Lg(ng)
      phyto(SMALL)%k_fed     = k_fed_Sm(ng)
      phyto(LARGE)%k_nh4     = k_nh4_Lg(ng)
      phyto(SMALL)%k_nh4     = k_nh4_Sm(ng)
      phyto(DIAZO)%k_nh4     = k_nh4_Di(ng)
      phyto(LARGE)%k_no3     = k_no3_Lg(ng)
      phyto(SMALL)%k_no3     = k_no3_Sm(ng)
      phyto(DIAZO)%k_no3     = k_no3_Di(ng)
      phyto(DIAZO)%k_po4     = k_po4_Di(ng)
      phyto(LARGE)%k_po4     = k_po4_Lg(ng)
      phyto(SMALL)%k_po4     = k_po4_Sm(ng)
      phyto(LARGE)%k_sio4    = k_sio4_Lg(ng)
      phyto(DIAZO)%k_fe_2_n  = k_fe_2_n_Di(ng)
      phyto(LARGE)%k_fe_2_n  = k_fe_2_n_Lg(ng)
      phyto(SMALL)%k_fe_2_n  = k_fe_2_n_Sm(ng)

      phyto(SMALL)%fe_2_n_max = fe_2_n_max_Sm(ng)
      phyto(LARGE)%fe_2_n_max = fe_2_n_max_Lg(ng)
      phyto(DIAZO)%fe_2_n_max = fe_2_n_max_Di(ng)

      cobalt%fe_2_n_upt_fac  = fe_2_n_upt_fac(ng)
      phyto(DIAZO)%alpha     = alpha_Di(ng)
      phyto(LARGE)%alpha     = alpha_Lg(ng)
      phyto(SMALL)%alpha     = alpha_Sm(ng)
      cobalt%kappa_eppley    = kappa_eppley(ng)
      phyto(DIAZO)%P_C_max   = P_C_max_Di(ng)
      phyto(LARGE)%P_C_max   = P_C_max_Lg(ng)
      phyto(SMALL)%P_C_max   = P_C_max_Sm(ng)
      phyto(DIAZO)%thetamax  = thetamax_Di(ng)
      phyto(LARGE)%thetamax  = thetamax_Lg(ng)
      phyto(SMALL)%thetamax  = thetamax_Sm(ng)
      phyto(DIAZO)%bresp     = bresp_Di(ng)
      phyto(LARGE)%bresp     = bresp_Lg(ng)
      phyto(SMALL)%bresp     = bresp_Sm(ng)
      cobalt%thetamin        = thetamin(ng)
      cobalt%thetamin_nolim  = thetamin_nolim(ng)
      cobalt%zeta            = zpllgr(ng)
      cobalt%gamma_irr_mem   = gamma_irr_mem(ng)
      cobalt%k_n_inhib_Di    = k_n_inhib_Di(ng)
      cobalt%o2_inhib_Di_pow = o2_inhib_Di_pow(ng)
      cobalt%o2_inhib_Di_sat = o2_inhib_Di_sat(ng)

      IF (p_2_n_static(ng) == 1 ) THEN
        cobalt%p_2_n_static    = .true.
      ELSE
        cobalt%p_2_n_static    = .false.
      ENDIF

      cobalt%c_2_n           = c_2_n(ng)
      cobalt%alk_2_n_denit   = alk_2_n_denit(ng)

      phyto(DIAZO)%p_2_n_static  = p_2_n_static_Di(ng)
      phyto(LARGE)%p_2_n_static  = p_2_n_static_Lg(ng)
      phyto(SMALL)%p_2_n_static  = p_2_n_static_Sm(ng)
      phyto(LARGE)%si_2_n_static = si_2_n_static_Lg(ng)
      phyto(LARGE)%si_2_n_max    = si_2_n_max_Lg(ng)

      cobalt%ca_2_n_arag   = ca_2_n_arag(ng)
      cobalt%ca_2_n_calc   = ca_2_n_calc(ng)
      cobalt%caco3_sat_max = caco3_sat_max(ng)
      zoo(1)%q_p_2_n       = q_p_2_n_smz(ng)
      zoo(2)%q_p_2_n       = q_p_2_n_mdz(ng)
      zoo(3)%q_p_2_n       = q_p_2_n_lgz(ng)
      bact(1)%q_p_2_n      = q_p_2_n_bact(ng)
      phyto(SMALL)%agg     = agg_Sm(ng)
      phyto(DIAZO)%agg     = agg_Di(ng)
      phyto(LARGE)%agg     = agg_Lg(ng)
      phyto(SMALL)%vir     = vir_Sm(ng)
      phyto(DIAZO)%vir     = vir_Di(ng)
      phyto(LARGE)%vir     = vir_Lg(ng)
      bact(1)%vir          = vir_Bact(ng)
      cobalt%vir_ktemp     = ktemp_vir(ng)
      phyto(SMALL)%exu     = exu_Sm(ng)
      phyto(DIAZO)%exu     = exu_Di(ng)
      phyto(LARGE)%exu     = exu_Lg(ng)
      zoo(1)%imax          = imax_smz(ng)
      zoo(2)%imax          = imax_mdz(ng)
      zoo(3)%imax          = imax_lgz(ng)
      zoo(1)%ki            = ki_smz(ng)
      zoo(2)%ki            = ki_mdz(ng)
      zoo(3)%ki            = ki_lgz(ng)
      zoo(1)%ktemp         = ktemp_smz(ng)
      zoo(2)%ktemp         = ktemp_mdz(ng)
      zoo(3)%ktemp         = ktemp_lgz(ng)
      bact(1)%mu_max       = mu_max_bact(ng)
      bact(1)%k_ldon       = k_ldon_bact(ng)
      bact(1)%ktemp        = ktemp_bact(ng)
      zoo(1)%nswitch       = nswitch_smz(ng)
      zoo(2)%nswitch       = nswitch_mdz(ng)
      zoo(3)%nswitch       = nswitch_lgz(ng)
      zoo(1)%mswitch       = mswitch_smz(ng)
      zoo(2)%mswitch       = mswitch_mdz(ng)
      zoo(3)%mswitch       = mswitch_lgz(ng)
      zoo(1)%ipa_smp       = smz_ipa_smp(ng)
      zoo(1)%ipa_lgp       = smz_ipa_lgp(ng)
      zoo(1)%ipa_diaz      = smz_ipa_diaz(ng)
      zoo(1)%ipa_smz       = smz_ipa_smz(ng)
      zoo(1)%ipa_mdz       = smz_ipa_mdz(ng)
      zoo(1)%ipa_lgz       = smz_ipa_lgz(ng)
      zoo(1)%ipa_bact      = smz_ipa_bact(ng)
      zoo(1)%ipa_det       = smz_ipa_det(ng)
      zoo(2)%ipa_smp       = mdz_ipa_smp(ng)
      zoo(2)%ipa_lgp       = mdz_ipa_lgp(ng)
      zoo(2)%ipa_diaz      = mdz_ipa_diaz(ng)
      zoo(2)%ipa_smz       = mdz_ipa_smz(ng)
      zoo(2)%ipa_mdz       = mdz_ipa_mdz(ng)
      zoo(2)%ipa_lgz       = mdz_ipa_lgz(ng)
      zoo(2)%ipa_bact      = mdz_ipa_bact(ng)
      zoo(2)%ipa_det       = mdz_ipa_det(ng)
      zoo(3)%ipa_smp       = lgz_ipa_smp(ng)
      zoo(3)%ipa_lgp       = lgz_ipa_lgp(ng)
      zoo(3)%ipa_diaz      = lgz_ipa_diaz(ng)
      zoo(3)%ipa_smz       = lgz_ipa_smz(ng)
      zoo(3)%ipa_mdz       = lgz_ipa_mdz(ng)
      zoo(3)%ipa_lgz       = lgz_ipa_lgz(ng)
      zoo(3)%ipa_bact      = lgz_ipa_bact(ng)
      zoo(3)%ipa_det       = lgz_ipa_det(ng)
      zoo(1)%gge_max       = gge_max_smz(ng)
      zoo(2)%gge_max       = gge_max_mdz(ng)
      zoo(3)%gge_max       = gge_max_lgz(ng)
      zoo(1)%bresp         = bresp_smz(ng)
      zoo(2)%bresp         = bresp_mdz(ng)
      zoo(3)%bresp         = bresp_lgz(ng)
      bact(1)%gge_max      = gge_max_bact(ng)
      bact(1)%bresp        = bresp_bact(ng)
      zoo(1)%phi_det       = phi_det_smz(ng)
      zoo(2)%phi_det       = phi_det_mdz(ng)
      zoo(3)%phi_det       = phi_det_lgz(ng)
      zoo(1)%phi_ldon      = phi_ldon_smz(ng)
      zoo(2)%phi_ldon      = phi_ldon_mdz(ng)
      zoo(3)%phi_ldon      = phi_ldon_lgz(ng)
      zoo(1)%phi_ldop      = phi_ldop_smz(ng)
      zoo(2)%phi_ldop      = phi_ldop_mdz(ng)
      zoo(3)%phi_ldop      = phi_ldop_lgz(ng)
      zoo(1)%phi_srdon     = phi_srdon_smz(ng)
      zoo(2)%phi_srdon     = phi_srdon_mdz(ng)
      zoo(3)%phi_srdon     = phi_srdon_lgz(ng)
      zoo(1)%phi_srdop     = phi_srdop_smz(ng)
      zoo(2)%phi_srdop     = phi_srdop_mdz(ng)
      zoo(3)%phi_srdop     = phi_srdop_lgz(ng)
      zoo(1)%phi_sldon     = phi_sldon_smz(ng)
      zoo(2)%phi_sldon     = phi_sldon_mdz(ng)
      zoo(3)%phi_sldon     = phi_sldon_lgz(ng)
      zoo(1)%phi_sldop     = phi_sldop_smz(ng)
      zoo(2)%phi_sldop     = phi_sldop_mdz(ng)
      zoo(3)%phi_sldop     = phi_sldop_lgz(ng)
      zoo(1)%phi_nh4       = phi_nh4_smz(ng)
      zoo(2)%phi_nh4       = phi_nh4_mdz(ng)
      zoo(3)%phi_nh4       = phi_nh4_lgz(ng)
      zoo(1)%phi_po4       = phi_po4_smz(ng)
      zoo(2)%phi_po4       = phi_po4_mdz(ng)
      zoo(3)%phi_po4       = phi_po4_lgz(ng)

      cobalt%lysis_phi_ldon  = phi_ldon_vir(ng)
      cobalt%lysis_phi_srdon = phi_srdon_vir(ng)
      cobalt%lysis_phi_sldon = phi_sldon_vir(ng)
      cobalt%lysis_phi_ldop  = phi_ldop_vir(ng)
      cobalt%lysis_phi_srdop = phi_srdop_vir(ng)
      cobalt%lysis_phi_sldop = phi_sldop_vir(ng)

      cobalt%imax_hp       = imax_hp(ng)
      cobalt%ki_hp         = ki_hp(ng)
      cobalt%coef_hp       = coef_hp(ng)
      cobalt%ktemp_hp      = ktemp_hp(ng)
      cobalt%nswitch_hp    = nswitch_hp(ng)
      cobalt%mswitch_hp    = mswitch_hp(ng)
      cobalt%hp_ipa_smp    = hp_ipa_smp(ng)
      cobalt%hp_ipa_lgp    = hp_ipa_lgp(ng)
      cobalt%hp_ipa_diaz   = hp_ipa_diaz(ng)
      cobalt%hp_ipa_smz    = hp_ipa_smz(ng)
      cobalt%hp_ipa_mdz    = hp_ipa_mdz(ng)
      cobalt%hp_ipa_lgz    = hp_ipa_lgz(ng)
      cobalt%hp_ipa_bact   = hp_ipa_bact(ng)
      cobalt%hp_ipa_det    = hp_ipa_det(ng)
      cobalt%hp_phi_det    = hp_phi_det(ng)
      cobalt%hp_phi_ldon   = hp_phi_ldon(ng)
      cobalt%hp_phi_ldop   = hp_phi_ldop(ng)
      cobalt%hp_phi_srdon  = hp_phi_srdon(ng)
      cobalt%hp_phi_srdop  = hp_phi_srdop(ng)
      cobalt%hp_phi_sldon  = hp_phi_sldon(ng)
      cobalt%hp_phi_sldop  = hp_phi_sldop(ng)
      cobalt%hp_phi_nh4    = hp_phi_nh4(ng)
      cobalt%hp_phi_po4    = hp_phi_po4(ng)
      cobalt%felig_bkg     = felig_bkg(ng)
      cobalt%felig_2_don   = felig_2_don(ng)
      cobalt%fe_2_n_sed    = fe_2_n_sed(ng)
      cobalt%fe_coast      = fe_coast(ng)
      cobalt%alpha_fescav  = alpha_fescav(ng)
      cobalt%beta_fescav   = beta_fescav(ng)
      cobalt%remin_eff_fedet = remin_eff_fedet(ng)
      cobalt%ki_fescav     = ki_fescav(ng)
      cobalt%io_fescav     = io_fescav(ng)
      cobalt%gamma_fescav  = gamma_fescav(ng)
      cobalt%kfe_eq_lig_ll = kfe_eq_lig_ll(ng)
      cobalt%kfe_eq_lig_hl = kfe_eq_lig_hl(ng)
      cobalt%k_o2          = k_o2(ng)
      cobalt%o2_min        = o2_min(ng)
      cobalt%rpcaco3       = rpcaco3(ng)
      cobalt%rplith        = rplith(ng)
      cobalt%rpsio2        = rpsio2(ng)
      cobalt%gamma_ndet    = gamma_ndet(ng)
      cobalt%gamma_cadet_arag = gamma_cadet_arag(ng)
      cobalt%gamma_cadet_calc = gamma_cadet_calc(ng)
      cobalt%gamma_sidet   = gamma_sidet(ng)
      cobalt%phi_lith      = phi_lith(ng)
      cobalt%k_lith        = k_lith(ng)
      cobalt%z_sed         = z_sed(ng)
      cobalt%k_no3_denit   = k_no3_denit(ng)
      cobalt%gamma_srdon   = gamma_srdon(ng)
      cobalt%gamma_srdop   = gamma_srdop(ng)
      cobalt%gamma_sldon   = gamma_sldon(ng)
      cobalt%gamma_sldop   = gamma_sldop(ng)
      cobalt%gamma_nitrif  = gamma_nitrif(ng)
      cobalt%irr_inhibit   = irr_inhibit(ng)
      !cobalt%tracer_debug = tracer_debug(ng)
      cobalt%htotal_in     = htotal_in(ng)
      cobalt%wsink         = wsink(ng)

      RETURN

      END SUBROUTINE cobalt_add_params
